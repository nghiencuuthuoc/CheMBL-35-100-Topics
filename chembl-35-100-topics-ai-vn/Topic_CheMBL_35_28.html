
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Topic_CheMBL_35_28</title>
            <style>
                body {
                    font-family: "Georgia", serif;
                    max-width: 800px;
                    margin: 40px auto;
                    padding: 20px;
                    line-height: 1.6;
                    background-color: #ffffff;
                    color: #333;
                }
                h1, h2, h3 {
                    color: #1a1a1a;
                }
                code {
                    background-color: #f5f5f5;
                    padding: 2px 4px;
                    border-radius: 4px;
                }
                pre {
                    background-color: #f5f5f5;
                    padding: 10px;
                    overflow-x: auto;
                    border-radius: 6px;
                }
            </style>
        </head>
        <body>
        <h1>PharmApp Suite</h1>
<h2>üß† AI for Drug Discovery and Development üß™</h2>
<p>| Copyright 2025 | Nghi√™n C·ª©u Thu·ªëc | www.nghiencuuthuoc.comlus | Zalo: +84888999311 |</p>
<h1>üß© Topic: √Ånh x·∫° protein gi·ªØa ng∆∞·ªùi v√† chu·ªôt</h1>
<hr />
<p>Tuy·ªát v·ªùi! V·ªõi vai tr√≤ l√† m·ªôt chuy√™n gia nghi√™n c·ª©u v√† ph√°t tri·ªÉn d∆∞·ª£c h·ªçc, t√¥i r·∫•t vui ƒë∆∞·ª£c h·ªó tr·ª£ b·∫°n trong d·ª± √°n ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL 35 s·ª≠ d·ª•ng RDKit. D∆∞·ªõi ƒë√¢y l√† ph√¢n t√≠ch, h∆∞·ªõng d·∫´n song ng·ªØ, code m·∫´u SQL v√† Python ƒë·ªÉ gi√∫p b·∫°n b·∫Øt ƒë·∫ßu, ƒë·ªìng th·ªùi gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ b·∫°n ƒë√£ ƒë·ªÅ c·∫≠p.</p>
<p><strong>Ch·ªß ƒë·ªÅ: Topic_CheMBL_35_28</strong></p>
<p><strong>T√™n ch·ªß ƒë·ªÅ: Ph√¢n t√≠ch m·ªëi t∆∞∆°ng quan gi·ªØa c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a (Physicochemical Properties) v√† ho·∫°t t√≠nh sinh h·ªçc (Biological Activity) c·ªßa c√°c h·ª£p ch·∫•t trong ChEMBL 35.</strong></p>
<p><strong>1. Ph√¢n t√≠ch m√¥ h√¨nh ph√¢n t√≠ch (Analysis of Analytical Model):</strong></p>
<p>M·ª•c ti√™u c·ªßa ch·ªß ƒë·ªÅ n√†y l√† t√¨m hi·ªÉu xem c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a c·ªßa m·ªôt ph√¢n t·ª≠ (v√≠ d·ª•: tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠, logP, s·ªë l∆∞·ª£ng li√™n k·∫øt hydro, v.v.) ·∫£nh h∆∞·ªüng nh∆∞ th·∫ø n√†o ƒë·∫øn ho·∫°t t√≠nh sinh h·ªçc c·ªßa n√≥ (v√≠ d·ª•: IC50, Ki).  M√¥ h√¨nh ph√¢n t√≠ch s·∫Ω bao g·ªìm c√°c b∆∞·ªõc sau:</p>
<ul>
<li><strong>Thu th·∫≠p v√† ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu:</strong> L·∫•y d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35, l√†m s·∫°ch v√† chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu v·ªÅ ho·∫°t t√≠nh sinh h·ªçc (v√≠ d·ª•: chuy·ªÉn ƒë·ªïi IC50 sang pIC50).</li>
<li><strong>T√≠nh to√°n c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a:</strong> S·ª≠ d·ª•ng RDKit ƒë·ªÉ t√≠nh to√°n c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a cho m·ªói ph√¢n t·ª≠.</li>
<li><strong>Ph√¢n t√≠ch t∆∞∆°ng quan:</strong> S·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p th·ªëng k√™ (v√≠ d·ª•: h·ªìi quy tuy·∫øn t√≠nh, h·ªìi quy ƒëa bi·∫øn) ƒë·ªÉ ƒë√°nh gi√° m·ªëi t∆∞∆°ng quan gi·ªØa c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a v√† ho·∫°t t√≠nh sinh h·ªçc.</li>
<li><strong>X√¢y d·ª±ng m√¥ h√¨nh d·ª± ƒëo√°n:</strong> (T√πy ch·ªçn) X√¢y d·ª±ng m√¥ h√¨nh m√°y h·ªçc ƒë·ªÉ d·ª± ƒëo√°n ho·∫°t t√≠nh sinh h·ªçc d·ª±a tr√™n c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a.</li>
<li><strong>ƒê√°nh gi√° m√¥ h√¨nh:</strong> ƒê√°nh gi√° hi·ªáu su·∫•t c·ªßa m√¥ h√¨nh b·∫±ng c√°ch s·ª≠ d·ª•ng c√°c ch·ªâ s·ªë ph√π h·ª£p (v√≠ d·ª•: R-squared, RMSE).</li>
</ul>
<p><strong>In English:</strong></p>
<p>The goal of this topic is to understand how the physicochemical properties of a molecule (e.g., molecular weight, logP, number of hydrogen bonds, etc.) affect its biological activity (e.g., IC50, Ki). The analytical model will include the following steps:</p>
<ul>
<li><strong>Data Collection and Preprocessing:</strong> Retrieve data from the ChEMBL 35 database, clean, and transform the biological activity data (e.g., convert IC50 to pIC50).</li>
<li><strong>Calculation of Physicochemical Properties:</strong> Use RDKit to calculate physicochemical properties for each molecule.</li>
<li><strong>Correlation Analysis:</strong> Use statistical methods (e.g., linear regression, multivariate regression) to assess the correlation between physicochemical properties and biological activity.</li>
<li><strong>Building a Predictive Model:</strong> (Optional) Build a machine learning model to predict biological activity based on physicochemical properties.</li>
<li><strong>Model Evaluation:</strong> Evaluate the performance of the model using appropriate metrics (e.g., R-squared, RMSE).</li>
</ul>
<p><strong>2. H∆∞·ªõng d·∫´n song ng·ªØ (Bilingual Instructions):</strong></p>
<p><strong>B∆∞·ªõc 1: K·∫øt n·ªëi ƒë·∫øn c∆° s·ªü d·ªØ li·ªáu ChEMBL 35 (Connect to ChEMBL 35 Database):</strong></p>
<p>S·ª≠ d·ª•ng th√¥ng tin b·∫°n cung c·∫•p ƒë·ªÉ k·∫øt n·ªëi ƒë·∫øn c∆° s·ªü d·ªØ li·ªáu PostgreSQL.</p>
<p>```python
import psycopg2</p>
<p>conn = psycopg2.connect(
    host="192.168.206.136",
    user="rd",
    password="rd",
    database="chembl_35"
)</p>
<p>cursor = conn.cursor()
```</p>
<p><strong>In English:</strong></p>
<p>Use the information you provided to connect to the PostgreSQL database.</p>
<p><strong>B∆∞·ªõc 2: Truy v·∫•n d·ªØ li·ªáu t·ª´ ChEMBL 35 (Query Data from ChEMBL 35):</strong></p>
<p>S·ª≠ d·ª•ng SQL ƒë·ªÉ truy v·∫•n d·ªØ li·ªáu c·∫ßn thi·∫øt. <strong>L∆∞u √Ω l·ªói li√™n quan ƒë·∫øn to√°n t·ª≠ ~</strong>. To√°n t·ª≠ <code>~</code> trong PostgreSQL l√† to√°n t·ª≠ so s√°nh pattern matching (t∆∞∆°ng t·ª± regex). ƒê·ªÉ kh·∫Øc ph·ª•c l·ªói "ERROR: operator does not exist: numeric ~ unknown", b·∫°n c·∫ßn ƒë·∫£m b·∫£o r·∫±ng c·ªôt <code>act.standard_value</code> ph·∫£i l√† ki·ªÉu d·ªØ li·ªáu text tr∆∞·ªõc khi s·ª≠ d·ª•ng to√°n t·ª≠ <code>~</code>.</p>
<p><code>sql
-- L·∫•y 100 d√≤ng d·ªØ li·ªáu
SELECT
    cmp.chembl_id,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    compound_structures cmp
JOIN
    activities act ON cmp.molregno = act.molregno
WHERE act.standard_type = 'IC50'
AND act.standard_units = 'nM'
AND act.standard_value IS NOT NULL
AND act.standard_value::text ~ '^[0-9\.]+$' -- √âp ki·ªÉu v·ªÅ text tr∆∞·ªõc khi so s√°nh
LIMIT 100;</code></p>
<p><strong>In English:</strong></p>
<p>Use SQL to query the necessary data. <strong>Note the error related to the ~ operator.</strong> The <code>~</code> operator in PostgreSQL is a pattern matching operator (similar to regex). To fix the error "ERROR: operator does not exist: numeric ~ unknown", you need to ensure that the <code>act.standard_value</code> column is of text data type before using the <code>~</code> operator. The <code>::text</code> cast ensures this.</p>
<p><strong>B∆∞·ªõc 3: L∆∞u d·ªØ li·ªáu v√†o file CSV (Save Data to CSV File):</strong></p>
<p>S·ª≠ d·ª•ng <code>psycopg2</code> ƒë·ªÉ l·∫•y d·ªØ li·ªáu v√† l∆∞u v√†o file CSV.</p>
<p>```python
import csv
import os</p>
<p>base_path = "../data"  # ƒê·∫£m b·∫£o ƒë∆∞·ªùng d·∫´n n√†y ƒë√∫ng v·ªõi c·∫•u tr√∫c th∆∞ m·ª•c c·ªßa b·∫°n</p>
<p>sql_query = """
SELECT
    cmp.chembl_id,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    compound_structures cmp
JOIN
    activities act ON cmp.molregno = act.molregno
WHERE act.standard_type = 'IC50'
AND act.standard_units = 'nM'
AND act.standard_value IS NOT NULL
AND act.standard_value::text ~ '^[0-9.]+$'
LIMIT 100;
"""</p>
<p>cursor.execute(sql_query)
results = cursor.fetchall()</p>
<p>csv_file_path = os.path.join(base_path, "chembl_data.csv")</p>
<p>with open(csv_file_path, 'w', newline='') as csvfile:
    csv_writer = csv.writer(csvfile)
    csv_writer.writerow([i[0] for i in cursor.description])  # Ghi header
    csv_writer.writerows(results)</p>
<p>print(f"D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u v√†o: {csv_file_path}")</p>
<p>conn.close()
```</p>
<p><strong>In English:</strong></p>
<p>Use <code>psycopg2</code> to retrieve the data and save it to a CSV file.</p>
<p><strong>B∆∞·ªõc 4: ƒê·ªçc d·ªØ li·ªáu t·ª´ file CSV v√† t√≠nh to√°n ƒë·∫∑c t√≠nh l√Ω h√≥a b·∫±ng RDKit (Read Data from CSV File and Calculate Physicochemical Properties using RDKit):</strong></p>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import numpy as np</p>
<h1>ƒê·ªçc d·ªØ li·ªáu t·ª´ file CSV</h1>
<p>csv_file_path = os.path.join(base_path, "chembl_data.csv")
df = pd.read_csv(csv_file_path)</p>
<h1>H√†m t√≠nh to√°n ƒë·∫∑c t√≠nh l√Ω h√≥a</h1>
<p>def calculate_physicochemical_properties(chembl_id):
    try:
        # L·∫•y SMILES t·ª´ ChEMBL (c·∫ßn m·ªôt truy v·∫•n SQL kh√°c)
        sql_query = f"""
        SELECT cs.canonical_smiles
        FROM compound_structures cs
        WHERE cs.chembl_id = '{chembl_id}'
        """
        cursor = conn.cursor()
        cursor.execute(sql_query)
        smiles = cursor.fetchone()[0]</p>
<pre><code>    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None

    # T√≠nh to√°n c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a
    mw = Descriptors.MolWt(mol)
    logp = Chem.Crippen.MolLogP(mol)
    hbd = Chem.rdMolDescriptors.CalcNumHBD(mol)
    hba = Chem.rdMolDescriptors.CalcNumHBA(mol)
    return mw, logp, hbd, hba
except Exception as e:
    print(f"L·ªói khi t√≠nh to√°n ƒë·∫∑c t√≠nh cho {chembl_id}: {e}")
    return None
</code></pre>
<h1>√Åp d·ª•ng h√†m t√≠nh to√°n ƒë·∫∑c t√≠nh l√Ω h√≥a cho m·ªói h·ª£p ch·∫•t</h1>
<p>df[['molecular_weight', 'logp', 'hbd', 'hba']] = df['chembl_id'].apply(lambda x: pd.Series(calculate_physicochemical_properties(x)))</p>
<h1>Chuy·ªÉn ƒë·ªïi standard_value sang pIC50</h1>
<p>df = df.dropna(subset=['standard_value'])
df['standard_value'] = pd.to_numeric(df['standard_value'])
df['pIC50'] = -np.log10(df['standard_value'] * 1e-9)  # Chuy·ªÉn ƒë·ªïi nM sang M</p>
<h1>In ra DataFrame</h1>
<p>print(df.head())
```</p>
<p><strong>In English:</strong></p>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import numpy as np</p>
<h1>Read data from CSV file</h1>
<p>csv_file_path = os.path.join(base_path, "chembl_data.csv")
df = pd.read_csv(csv_file_path)</p>
<h1>Function to calculate physicochemical properties</h1>
<p>def calculate_physicochemical_properties(chembl_id):
    try:
        # Get SMILES from ChEMBL (requires another SQL query)
        sql_query = f"""
        SELECT cs.canonical_smiles
        FROM compound_structures cs
        WHERE cs.chembl_id = '{chembl_id}'
        """
        cursor = conn.cursor()
        cursor.execute(sql_query)
        smiles = cursor.fetchone()[0]</p>
<pre><code>    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None

    # Calculate physicochemical properties
    mw = Descriptors.MolWt(mol)
    logp = Chem.Crippen.MolLogP(mol)
    hbd = Chem.rdMolDescriptors.CalcNumHBD(mol)
    hba = Chem.rdMolDescriptors.CalcNumHBA(mol)
    return mw, logp, hbd, hba
except Exception as e:
    print(f"Error calculating properties for {chembl_id}: {e}")
    return None
</code></pre>
<h1>Apply the function to each compound</h1>
<p>df[['molecular_weight', 'logp', 'hbd', 'hba']] = df['chembl_id'].apply(lambda x: pd.Series(calculate_physicochemical_properties(x)))</p>
<h1>Convert standard_value to pIC50</h1>
<p>df = df.dropna(subset=['standard_value'])
df['standard_value'] = pd.to_numeric(df['standard_value'])
df['pIC50'] = -np.log10(df['standard_value'] * 1e-9)  # Convert nM to M</p>
<h1>Print the DataFrame</h1>
<p>print(df.head())
```</p>
<p><strong>B∆∞·ªõc 5: Ph√¢n t√≠ch t∆∞∆°ng quan (Correlation Analysis):</strong></p>
<p>```python</p>
<h1>T√≠nh to√°n ma tr·∫≠n t∆∞∆°ng quan</h1>
<p>correlation_matrix = df[['pIC50', 'molecular_weight', 'logp', 'hbd', 'hba']].corr()
print(correlation_matrix)</p>
<p>import matplotlib.pyplot as plt
import seaborn as sns</p>
<p>sns.heatmap(correlation_matrix, annot=True)
plt.show()
```</p>
<p><strong>In English:</strong></p>
<p>```python</p>
<h1>Calculate the correlation matrix</h1>
<p>correlation_matrix = df[['pIC50', 'molecular_weight', 'logp', 'hbd', 'hba']].corr()
print(correlation_matrix)</p>
<p>import matplotlib.pyplot as plt
import seaborn as sns</p>
<p>sns.heatmap(correlation_matrix, annot=True)
plt.show()
```</p>
<p><strong>B∆∞·ªõc 6: X√¢y d·ª±ng m√¥ h√¨nh h·ªìi quy (Regression Model):</strong></p>
<p>```python
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score</p>
<h1>Chu·∫©n b·ªã d·ªØ li·ªáu</h1>
<p>X = df[['molecular_weight', 'logp', 'hbd', 'hba']].fillna(0)  # ƒêi·ªÅn gi√° tr·ªã NaN b·∫±ng 0
y = df['pIC50'].fillna(0)</p>
<h1>Chia d·ªØ li·ªáu th√†nh t·∫≠p hu·∫•n luy·ªán v√† t·∫≠p ki·ªÉm tra</h1>
<p>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</p>
<h1>X√¢y d·ª±ng m√¥ h√¨nh h·ªìi quy tuy·∫øn t√≠nh</h1>
<p>model = LinearRegression()
model.fit(X_train, y_train)</p>
<h1>D·ª± ƒëo√°n tr√™n t·∫≠p ki·ªÉm tra</h1>
<p>y_pred = model.predict(X_test)</p>
<h1>ƒê√°nh gi√° m√¥ h√¨nh</h1>
<p>mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)</p>
<p>print(f"Mean Squared Error: {mse}")
print(f"R-squared: {r2}")
```</p>
<p><strong>In English:</strong></p>
<p>```python
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score</p>
<h1>Prepare the data</h1>
<p>X = df[['molecular_weight', 'logp', 'hbd', 'hba']].fillna(0)  # Fill NaN values with 0
y = df['pIC50'].fillna(0)</p>
<h1>Split the data into training and testing sets</h1>
<p>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</p>
<h1>Build a linear regression model</h1>
<p>model = LinearRegression()
model.fit(X_train, y_train)</p>
<h1>Predict on the test set</h1>
<p>y_pred = model.predict(X_test)</p>
<h1>Evaluate the model</h1>
<p>mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)</p>
<p>print(f"Mean Squared Error: {mse}")
print(f"R-squared: {r2}")
```</p>
<p><strong>L∆∞u √Ω v·ªÅ l·ªói sklearn:</strong> N·∫øu b·∫°n g·∫∑p l·ªói li√™n quan ƒë·∫øn <code>squared=False</code> trong <code>mean_squared_error</code>, h√£y ƒë·∫£m b·∫£o r·∫±ng b·∫°n ƒëang s·ª≠ d·ª•ng phi√™n b·∫£n scikit-learn m·ªõi nh·∫•t. N·∫øu kh√¥ng, b·∫°n c√≥ th·ªÉ t√≠nh cƒÉn b·∫≠c hai c·ªßa MSE ƒë·ªÉ c√≥ RMSE.</p>
<p><strong>3. Code SQL v√† Python m·∫´u (Sample SQL and Python Code):</strong></p>
<p>D∆∞·ªõi ƒë√¢y l√† 5 v√≠ d·ª• v·ªÅ code SQL v√† Python m·∫´u:</p>
<p><strong>V√≠ d·ª• 1: L·∫•y s·ªë l∆∞·ª£ng h·ª£p ch·∫•t cho m·ªói lo·∫°i ho·∫°t t√≠nh (SQL):</strong></p>
<p><code>sql
SELECT standard_type, COUNT(*) FROM activities GROUP BY standard_type;</code></p>
<p><strong>In English:</strong></p>
<p><code>sql
SELECT standard_type, COUNT(*) FROM activities GROUP BY standard_type;</code></p>
<p><strong>V√≠ d·ª• 1: L·∫•y SMILES canonical v√† molecular weight c·ªßa c√°c ch·∫•t (SQL, Python):</strong></p>
<p><code>sql
SELECT
    cmp.chembl_id,
    cs.canonical_smiles
FROM
    compound_structures cs join compound_properties cmp
    ON cs.molregno = cmp.molregno
LIMIT 10;</code></p>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors</p>
<p>def get_molecular_weight(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Descriptors.MolWt(mol)
    return None</p>
<p>sql_query = """
SELECT
    cmp.chembl_id,
    cs.canonical_smiles
FROM
    compound_structures cs join compound_properties cmp
    ON cs.molregno = cmp.molregno
LIMIT 10;
"""</p>
<p>cursor.execute(sql_query)
results = cursor.fetchall()</p>
<p>df = pd.DataFrame(results, columns=['chembl_id', 'smiles'])
df['molecular_weight'] = df['smiles'].apply(get_molecular_weight)</p>
<p>print(df)
```</p>
<p><strong>V√≠ d·ª• 2: T√≠nh to√°n LogP cho m·ªôt danh s√°ch c√°c ch·∫•t (Python):</strong></p>
<p>```python
from rdkit import Chem
from rdkit.Chem import Crippen</p>
<p>smiles_list = ['CC(=O)Oc1ccccc1C(=O)O', 'c1ccccc1', 'CCO']</p>
<p>for smiles in smiles_list:
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        logp = Crippen.MolLogP(mol)
        print(f"LogP for {smiles}: {logp}")
    else:
        print(f"Invalid SMILES: {smiles}")
```</p>
<p><strong>In English:</strong></p>
<p>```python
from rdkit import Chem
from rdkit.Chem import Crippen</p>
<p>smiles_list = ['CC(=O)Oc1ccccc1C(=O)O', 'c1ccccc1', 'CCO']</p>
<p>for smiles in smiles_list:
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        logp = Crippen.MolLogP(mol)
        print(f"LogP for {smiles}: {logp}")
    else:
        print(f"Invalid SMILES: {smiles}")
```</p>
<p><strong>V√≠ d·ª• 3: L·ªçc c√°c ch·∫•t c√≥ tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠ n·∫±m trong m·ªôt kho·∫£ng nh·∫•t ƒë·ªãnh (SQL, Python):</strong></p>
<p><code>sql
-- C·∫ßn t·∫°o m·ªôt view ho·∫∑c b·∫£ng t·∫°m ƒë·ªÉ l∆∞u tr·ªØ tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠
-- (V√≠ d·ª• n√†y ch·ªâ minh h·ªça logic, c·∫ßn ƒëi·ªÅu ch·ªânh cho ph√π h·ª£p v·ªõi c·∫•u tr√∫c DB)
SELECT chembl_id FROM compound_properties WHERE molecular_weight &gt; 200 AND molecular_weight &lt; 500;</code></p>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors</p>
<p>def calculate_mw(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Descriptors.MolWt(mol)
    return None</p>
<p>sql_query = """
SELECT
    cmp.chembl_id,
    cs.canonical_smiles
FROM
    compound_structures cs join compound_properties cmp
    ON cs.molregno = cmp.molregno
LIMIT 100;
"""</p>
<p>cursor.execute(sql_query)
results = cursor.fetchall()</p>
<p>df = pd.DataFrame(results, columns=['chembl_id', 'smiles'])
df['molecular_weight'] = df['smiles'].apply(calculate_mw)</p>
<p>filtered_df = df[(df['molecular_weight'] &gt; 200) &amp; (df['molecular_weight'] &lt; 500)]
print(filtered_df)
```</p>
<p><strong>V√≠ d·ª• 4: T√≠nh to√°n s·ªë l∆∞·ª£ng li√™n k·∫øt hydro cho v√† nh·∫≠n (Python):</strong></p>
<p>```python
from rdkit import Chem
from rdkit.Chem import rdMolDescriptors</p>
<p>smiles = 'CC(=O)Oc1ccccc1C(=O)O'
mol = Chem.MolFromSmiles(smiles)</p>
<p>if mol:
    hbd = rdMolDescriptors.CalcNumHBD(mol)
    hba = rdMolDescriptors.CalcNumHBA(mol)
    print(f"Hydrogen Bond Donors: {hbd}")
    print(f"Hydrogen Bond Acceptors: {hba}")
else:
    print("Invalid SMILES")
```</p>
<p><strong>In English:</strong></p>
<p>```python
from rdkit import Chem
from rdkit.Chem import rdMolDescriptors</p>
<p>smiles = 'CC(=O)Oc1ccccc1C(=O)O'
mol = Chem.MolFromSmiles(smiles)</p>
<p>if mol:
    hbd = rdMolDescriptors.CalcNumHBD(mol)
    hba = rdMolDescriptors.CalcNumHBA(mol)
    print(f"Hydrogen Bond Donors: {hbd}")
    print(f"Hydrogen Bond Acceptors: {hba}")
else:
    print("Invalid SMILES")
```</p>
<p><strong>V√≠ d·ª• 5: Ph√¢n t√≠ch t∆∞∆°ng quan gi·ªØa LogP v√† ho·∫°t t√≠nh (SQL, Python):</strong></p>
<p><strong>(SQL - √ù t∆∞·ªüng, c·∫ßn ƒëi·ªÅu ch·ªânh theo schema):</strong></p>
<p><code>sql
-- V√≠ d·ª• n√†y c·∫ßn k·∫øt h·ª£p d·ªØ li·ªáu t·ª´ nhi·ªÅu b·∫£ng v√† c√≥ th·ªÉ y√™u c·∫ßu t·∫°o view
-- M·ª•c ƒë√≠ch l√† minh h·ªça √Ω t∆∞·ªüng, c·∫ßn ƒëi·ªÅu ch·ªânh cho ph√π h·ª£p v·ªõi database schema
-- SELECT corr(logp, pIC50) FROM ... JOIN ... WHERE ...;</code></p>
<p>```python
import pandas as pd
import numpy as np
from rdkit import Chem
from rdkit.Chem import Crippen</p>
<h1>Gi·∫£ s·ª≠ b·∫°n ƒë√£ c√≥ DataFrame 'df' ch·ª©a SMILES v√† pIC50</h1>
<h1>V√≠ d·ª•:</h1>
<p>data = {'smiles': ['CC(=O)Oc1ccccc1C(=O)O', 'c1ccccc1', 'CCO'],
        'pIC50': [6.5, 7.0, 5.5]}
df = pd.DataFrame(data)</p>
<h1>T√≠nh LogP</h1>
<p>df['logp'] = df['smiles'].apply(lambda x: Crippen.MolLogP(Chem.MolFromSmiles(x)) if Chem.MolFromSmiles(x) else None)</p>
<h1>Lo·∫°i b·ªè c√°c h√†ng c√≥ gi√° tr·ªã LogP l√† None</h1>
<p>df = df.dropna(subset=['logp'])</p>
<h1>T√≠nh to√°n t∆∞∆°ng quan</h1>
<p>correlation = df['logp'].corr(df['pIC50'])
print(f"Correlation between LogP and pIC50: {correlation}")
```</p>
<p><strong>L∆∞u √Ω quan tr·ªçng:</strong></p>
<ul>
<li>Thay th·∫ø c√°c ƒë∆∞·ªùng d·∫´n file v√† th√¥ng tin k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu b·∫±ng th√¥ng tin ch√≠nh x√°c c·ªßa b·∫°n.</li>
<li>C√°c truy v·∫•n SQL c·∫ßn ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh ƒë·ªÉ ph√π h·ª£p v·ªõi c·∫•u tr√∫c c∆° s·ªü d·ªØ li·ªáu ChEMBL 35.</li>
<li>B·∫°n c√≥ th·ªÉ c·∫ßn c√†i ƒë·∫∑t c√°c th∆∞ vi·ªán Python c·∫ßn thi·∫øt (v√≠ d·ª•: <code>psycopg2</code>, <code>rdkit</code>, <code>pandas</code>, <code>scikit-learn</code>) b·∫±ng pip.</li>
<li>H√£y nh·ªõ ƒë√≥ng k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu sau khi ho√†n th√†nh.</li>
<li>ƒê·ªÉ s·ª≠ d·ª•ng l·∫°i c√°c ƒë·ªëi t∆∞·ª£ng cursor , h√£y t·∫°o l·∫°i ƒë·ªëi t∆∞·ª£ng m·ªõi sau khi close.</li>
<li>V·ªõi l∆∞·ª£ng d·ªØ li·ªáu l·ªõn, h√£y xem x√©t s·ª≠ d·ª•ng c√°c k·ªπ thu·∫≠t t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t.</li>
</ul>
<p>Ch√∫c b·∫°n th√†nh c√¥ng v·ªõi d·ª± √°n c·ªßa m√¨nh! N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi n√†o kh√°c, ƒë·ª´ng ng·∫ßn ng·∫°i h·ªèi.</p>
        </body>
        </html>
        
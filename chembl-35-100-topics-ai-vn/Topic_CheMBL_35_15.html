
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Topic_CheMBL_35_15</title>
            <style>
                body {
                    font-family: "Georgia", serif;
                    max-width: 800px;
                    margin: 40px auto;
                    padding: 20px;
                    line-height: 1.6;
                    background-color: #ffffff;
                    color: #333;
                }
                h1, h2, h3 {
                    color: #1a1a1a;
                }
                code {
                    background-color: #f5f5f5;
                    padding: 2px 4px;
                    border-radius: 4px;
                }
                pre {
                    background-color: #f5f5f5;
                    padding: 10px;
                    overflow-x: auto;
                    border-radius: 6px;
                }
            </style>
        </head>
        <body>
        <h1>PharmApp Suite</h1>
<h2>üß† AI for Drug Discovery and Development üß™</h2>
<p>| Copyright 2025 | Nghi√™n C·ª©u Thu·ªëc | www.nghiencuuthuoc.comlus | Zalo: +84888999311 |</p>
<h1>üß© Topic: Thi·∫øt k·∫ø th∆∞ vi·ªán h√≥a h·ªçc t·∫≠p trung t·ª´ ChEMBL</h1>
<hr />
<p>Tuy·ªát v·ªùi! T√¥i s·∫Ω h·ªó tr·ª£ b·∫°n trong d·ª± √°n ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL 35 k·∫øt h·ª£p RDKit n√†y. D∆∞·ªõi ƒë√¢y l√† ph√¢n t√≠ch chi ti·∫øt, h∆∞·ªõng d·∫´n song ng·ªØ, code m·∫´u SQL v√† Python, c√πng v·ªõi c√°c l∆∞u √Ω quan tr·ªçng ƒë·ªÉ gi·∫£i quy·∫øt c√°c l·ªói b·∫°n g·∫∑p ph·∫£i.</p>
<p><strong>1. Ph√¢n t√≠ch M√¥ h√¨nh (Analysis of the Model)</strong></p>
<p>D·ª± √°n c·ªßa b·∫°n t·∫≠p trung v√†o vi·ªác khai th√°c d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35 ƒë·ªÉ h·ªó tr·ª£ nghi√™n c·ª©u v√† ph√°t tri·ªÉn thu·ªëc. Vi·ªác k·∫øt h·ª£p ChEMBL v·ªõi RDKit cho ph√©p b·∫°n t·∫≠n d·ª•ng th√¥ng tin v·ªÅ ho·∫°t t√≠nh sinh h·ªçc c·ªßa c√°c h·ª£p ch·∫•t v√† c·∫•u tr√∫c h√≥a h·ªçc c·ªßa ch√∫ng.</p>
<p><strong>M√¥ h√¨nh ph√¢n t√≠ch bao g·ªìm c√°c b∆∞·ªõc ch√≠nh sau:</strong></p>
<ul>
<li><strong>Tr√≠ch xu·∫•t d·ªØ li·ªáu (Data Extraction):</strong> S·ª≠ d·ª•ng SQL ƒë·ªÉ truy v·∫•n d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35, t·∫≠p trung v√†o c√°c th√¥ng tin li√™n quan ƒë·∫øn ho·∫°t t√≠nh sinh h·ªçc (v√≠ d·ª•: IC50, Ki) v√† c·∫•u tr√∫c h√≥a h·ªçc (v√≠ d·ª•: SMILES).</li>
<li><strong>Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu (Data Preprocessing):</strong> L√†m s·∫°ch v√† chu·∫©n h√≥a d·ªØ li·ªáu, bao g·ªìm x·ª≠ l√Ω c√°c gi√° tr·ªã thi·∫øu, lo·∫°i b·ªè d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√† chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu v·ªÅ ƒë·ªãnh d·∫°ng ph√π h·ª£p cho ph√¢n t√≠ch.</li>
<li><strong>T√≠nh to√°n descriptor (Descriptor Calculation):</strong> S·ª≠ d·ª•ng RDKit ƒë·ªÉ t√≠nh to√°n c√°c descriptor h√≥a h·ªçc t·ª´ c·∫•u tr√∫c SMILES c·ªßa c√°c h·ª£p ch·∫•t. C√°c descriptor n√†y c√≥ th·ªÉ bao g·ªìm c√°c thu·ªôc t√≠nh v·∫≠t l√Ω, h√≥a h·ªçc v√† c·∫•u tr√∫c c·ªßa ph√¢n t·ª≠.</li>
<li><strong>Ph√¢n t√≠ch th·ªëng k√™ v√† m√¥ h√¨nh h√≥a (Statistical Analysis and Modeling):</strong> S·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p th·ªëng k√™ v√† h·ªçc m√°y ƒë·ªÉ ph√¢n t√≠ch m·ªëi quan h·ªá gi·ªØa c√°c descriptor h√≥a h·ªçc v√† ho·∫°t t√≠nh sinh h·ªçc. ƒêi·ªÅu n√†y c√≥ th·ªÉ bao g·ªìm x√¢y d·ª±ng c√°c m√¥ h√¨nh d·ª± ƒëo√°n ho·∫°t t√≠nh (v√≠ d·ª•: QSAR/QSPR), ph√¢n c·ª•m c√°c h·ª£p ch·∫•t d·ª±a tr√™n ƒë·∫∑c ƒëi·ªÉm h√≥a h·ªçc, ho·∫∑c x√°c ƒë·ªãnh c√°c ƒë·∫∑c ƒëi·ªÉm quan tr·ªçng li√™n quan ƒë·∫øn ho·∫°t t√≠nh.</li>
<li><strong>Tr·ª±c quan h√≥a d·ªØ li·ªáu (Data Visualization):</strong> S·ª≠ d·ª•ng c√°c c√¥ng c·ª• tr·ª±c quan h√≥a ƒë·ªÉ kh√°m ph√° d·ªØ li·ªáu v√† tr√¨nh b√†y k·∫øt qu·∫£ ph√¢n t√≠ch m·ªôt c√°ch r√µ r√†ng v√† d·ªÖ hi·ªÉu.</li>
</ul>
<p><strong>2. H∆∞·ªõng d·∫´n song ng·ªØ (Bilingual Instructions)</strong></p>
<p><strong>English:</strong></p>
<p>This project aims to analyze data from the ChEMBL 35 database to support drug discovery and development. By combining ChEMBL with RDKit, you can leverage information on the biological activity of compounds and their chemical structures.</p>
<p><strong>Key steps include:</strong></p>
<ul>
<li><strong>Data Extraction:</strong> Use SQL to query data from the ChEMBL 35 database, focusing on information related to biological activity (e.g., IC50, Ki) and chemical structures (e.g., SMILES).</li>
<li><strong>Data Preprocessing:</strong> Clean and standardize the data, including handling missing values, removing invalid data, and converting data to a suitable format for analysis.</li>
<li><strong>Descriptor Calculation:</strong> Use RDKit to calculate chemical descriptors from the SMILES structures of the compounds. These descriptors can include physical, chemical, and structural properties of the molecule.</li>
<li><strong>Statistical Analysis and Modeling:</strong> Use statistical and machine learning methods to analyze the relationship between chemical descriptors and biological activity. This can include building predictive activity models (e.g., QSAR/QSPR), clustering compounds based on chemical characteristics, or identifying important features related to activity.</li>
<li><strong>Data Visualization:</strong> Use visualization tools to explore the data and present the analysis results in a clear and understandable manner.</li>
</ul>
<p><strong>Ti·∫øng Vi·ªát:</strong></p>
<p>D·ª± √°n n√†y nh·∫±m ph√¢n t√≠ch d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35 ƒë·ªÉ h·ªó tr·ª£ nghi√™n c·ª©u v√† ph√°t tri·ªÉn thu·ªëc. B·∫±ng c√°ch k·∫øt h·ª£p ChEMBL v·ªõi RDKit, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng th√¥ng tin v·ªÅ ho·∫°t t√≠nh sinh h·ªçc c·ªßa c√°c h·ª£p ch·∫•t v√† c·∫•u tr√∫c h√≥a h·ªçc c·ªßa ch√∫ng.</p>
<p><strong>C√°c b∆∞·ªõc ch√≠nh bao g·ªìm:</strong></p>
<ul>
<li><strong>Tr√≠ch xu·∫•t d·ªØ li·ªáu:</strong> S·ª≠ d·ª•ng SQL ƒë·ªÉ truy v·∫•n d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35, t·∫≠p trung v√†o th√¥ng tin li√™n quan ƒë·∫øn ho·∫°t t√≠nh sinh h·ªçc (v√≠ d·ª•: IC50, Ki) v√† c·∫•u tr√∫c h√≥a h·ªçc (v√≠ d·ª•: SMILES).</li>
<li><strong>Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu:</strong> L√†m s·∫°ch v√† chu·∫©n h√≥a d·ªØ li·ªáu, bao g·ªìm x·ª≠ l√Ω c√°c gi√° tr·ªã thi·∫øu, lo·∫°i b·ªè d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√† chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu v·ªÅ ƒë·ªãnh d·∫°ng ph√π h·ª£p cho ph√¢n t√≠ch.</li>
<li><strong>T√≠nh to√°n descriptor:</strong> S·ª≠ d·ª•ng RDKit ƒë·ªÉ t√≠nh to√°n c√°c descriptor h√≥a h·ªçc t·ª´ c·∫•u tr√∫c SMILES c·ªßa c√°c h·ª£p ch·∫•t. C√°c descriptor n√†y c√≥ th·ªÉ bao g·ªìm c√°c thu·ªôc t√≠nh v·∫≠t l√Ω, h√≥a h·ªçc v√† c·∫•u tr√∫c c·ªßa ph√¢n t·ª≠.</li>
<li><strong>Ph√¢n t√≠ch th·ªëng k√™ v√† m√¥ h√¨nh h√≥a:</strong> S·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p th·ªëng k√™ v√† h·ªçc m√°y ƒë·ªÉ ph√¢n t√≠ch m·ªëi quan h·ªá gi·ªØa c√°c descriptor h√≥a h·ªçc v√† ho·∫°t t√≠nh sinh h·ªçc. ƒêi·ªÅu n√†y c√≥ th·ªÉ bao g·ªìm x√¢y d·ª±ng c√°c m√¥ h√¨nh d·ª± ƒëo√°n ho·∫°t t√≠nh (v√≠ d·ª•: QSAR/QSPR), ph√¢n c·ª•m c√°c h·ª£p ch·∫•t d·ª±a tr√™n ƒë·∫∑c ƒëi·ªÉm h√≥a h·ªçc, ho·∫∑c x√°c ƒë·ªãnh c√°c ƒë·∫∑c ƒëi·ªÉm quan tr·ªçng li√™n quan ƒë·∫øn ho·∫°t t√≠nh.</li>
<li><strong>Tr·ª±c quan h√≥a d·ªØ li·ªáu:</strong> S·ª≠ d·ª•ng c√°c c√¥ng c·ª• tr·ª±c quan h√≥a ƒë·ªÉ kh√°m ph√° d·ªØ li·ªáu v√† tr√¨nh b√†y k·∫øt qu·∫£ ph√¢n t√≠ch m·ªôt c√°ch r√µ r√†ng v√† d·ªÖ hi·ªÉu.</li>
</ul>
<p><strong>3. Code SQL v√† Python m·∫´u (Sample SQL and Python Code)</strong></p>
<p><strong>a. SQL (English &amp; Vietnamese)</strong></p>
<p>```sql
-- English: SQL query to extract data from ChEMBL 35 (limited to 100 rows)
-- Vietnamese: Truy v·∫•n SQL ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ ChEMBL 35 (gi·ªõi h·∫°n 100 d√≤ng)</p>
<p>SELECT
    md.chembl_id,
    cs.canonical_smiles,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'IC50' -- You can change this to other activity types
    AND act.standard_units = 'nM'
    --AND act.standard_value ~ '^[0-9.]+$' --Fixing the error, remove this.
LIMIT 100;</p>
<p>```</p>
<p><strong>L√Ω gi·∫£i l·ªói SQL:</strong></p>
<p>L·ªói <code>ERROR: operator does not exist: numeric ~ unknown</code> x·∫£y ra v√¨ b·∫°n ƒëang c·ªë g·∫Øng s·ª≠ d·ª•ng to√°n t·ª≠ <code>~</code> (regular expression match) tr√™n m·ªôt c·ªôt s·ªë (<code>act.standard_value</code>). Thay v√¨ s·ª≠ d·ª•ng regular expression, b·∫°n c√≥ th·ªÉ b·ªè qua d√≤ng n√†y n·∫øu b·∫°n ch·ªâ mu·ªën l·ªçc c√°c gi√° tr·ªã s·ªë. N·∫øu b·∫°n v·∫´n mu·ªën l·ªçc theo regular expression, b·∫°n c·∫ßn ƒë·∫£m b·∫£o r·∫±ng c·ªôt <code>act.standard_value</code> ƒë∆∞·ª£c √©p ki·ªÉu v·ªÅ ki·ªÉu text tr∆∞·ªõc khi s·ª≠ d·ª•ng to√°n t·ª≠ <code>~</code>. Tuy nhi√™n, trong tr∆∞·ªùng h·ª£p n√†y, c√≥ v·∫ª nh∆∞ vi·ªác b·ªè qua d√≤ng n√†y l√† gi·∫£i ph√°p ƒë∆°n gi·∫£n nh·∫•t.</p>
<p><strong>b. Python (English &amp; Vietnamese)</strong></p>
<p>```python</p>
<h1>English: Python code to read data from CSV, calculate descriptors, and perform basic analysis</h1>
<h1>Vietnamese: M√£ Python ƒë·ªÉ ƒë·ªçc d·ªØ li·ªáu t·ª´ CSV, t√≠nh to√°n descriptor v√† th·ª±c hi·ªán ph√¢n t√≠ch c∆° b·∫£n</h1>
<p>import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import os</p>
<h1>Define base path</h1>
<p>base_path = "../data"  # Adjust this to your actual base path</p>
<h1>Construct the file path</h1>
<p>csv_file_path = os.path.join(base_path, "your_extracted_data.csv") # Replace "your_extracted_data.csv" with your actual file name</p>
<h1>Read the CSV file</h1>
<p>try:
    df = pd.read_csv(csv_file_path)
    print("CSV file loaded successfully.")
except FileNotFoundError:
    print(f"Error: File not found at {csv_file_path}")
    exit()</p>
<h1>Function to calculate molecular weight</h1>
<p>def calculate_mw(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol:
            return Descriptors.MolWt(mol)
        else:
            return None
    except:
        return None</p>
<h1>Apply the function to the 'canonical_smiles' column</h1>
<p>df['molecular_weight'] = df['canonical_smiles'].apply(calculate_mw)</p>
<h1>Print some basic statistics</h1>
<p>print(df.describe())</p>
<h1>You can add more analysis here, such as plotting or more advanced calculations</h1>
<p>```</p>
<p><strong>4. V√≠ d·ª• Code SQL v√† Python (SQL and Python Code Examples)</strong></p>
<p>D∆∞·ªõi ƒë√¢y l√† 5 v√≠ d·ª• code SQL v√† Python kh√°c nhau ƒë·ªÉ b·∫°n tham kh·∫£o:</p>
<p><strong>V√≠ d·ª• 1: SQL - L·ªçc theo kho·∫£ng gi√° tr·ªã ho·∫°t t√≠nh (Filtering by activity range)</strong></p>
<p>```sql
-- English: SQL query to filter compounds with IC50 values between 10 and 100 nM
-- Vietnamese: Truy v·∫•n SQL ƒë·ªÉ l·ªçc c√°c h·ª£p ch·∫•t c√≥ gi√° tr·ªã IC50 n·∫±m trong kho·∫£ng t·ª´ 10 ƒë·∫øn 100 nM</p>
<p>SELECT
    md.chembl_id,
    cs.canonical_smiles,
    act.standard_value
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'IC50'
    AND act.standard_units = 'nM'
    AND act.standard_value &gt;= 10
    AND act.standard_value &lt;= 100
LIMIT 100;
```</p>
<p><strong>V√≠ d·ª• 1: Python - T√≠nh to√°n logP (Calculating logP)</strong></p>
<p>```python</p>
<h1>English: Python code to calculate LogP using RDKit</h1>
<h1>Vietnamese: M√£ Python ƒë·ªÉ t√≠nh to√°n LogP s·ª≠ d·ª•ng RDKit</h1>
<p>import pandas as pd
from rdkit import Chem
from rdkit.Chem import Crippen
import os</p>
<h1>Define base path</h1>
<p>base_path = "../data"  # Adjust this to your actual base path</p>
<h1>Construct the file path</h1>
<p>csv_file_path = os.path.join(base_path, "your_extracted_data.csv") # Replace "your_extracted_data.csv" with your actual file name</p>
<h1>Read the CSV file</h1>
<p>try:
    df = pd.read_csv(csv_file_path)
    print("CSV file loaded successfully.")
except FileNotFoundError:
    print(f"Error: File not found at {csv_file_path}")
    exit()</p>
<p>def calculate_logp(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol:
            return Crippen.MolLogP(mol)
        else:
            return None
    except:
        return None</p>
<p>df['logp'] = df['canonical_smiles'].apply(calculate_logp)</p>
<p>print(df[['chembl_id', 'canonical_smiles', 'logp']].head())
```</p>
<p><strong>V√≠ d·ª• 2: SQL - L·ªçc theo m·ª•c ti√™u (Filtering by Target)</strong></p>
<p>```sql
-- English: SQL query to filter compounds targeting a specific protein (replace 'CHEMBL205' with the actual target ID)
-- Vietnamese: Truy v·∫•n SQL ƒë·ªÉ l·ªçc c√°c h·ª£p ch·∫•t nh·∫Øm m·ª•c ti√™u v√†o m·ªôt protein c·ª• th·ªÉ (thay th·∫ø 'CHEMBL205' b·∫±ng ID m·ª•c ti√™u th·ª±c t·∫ø)</p>
<p>SELECT
    md.chembl_id,
    cs.canonical_smiles,
    act.standard_value
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
JOIN
    target_dictionary td ON act.tid = td.tid
WHERE
    td.chembl_id = 'CHEMBL205'
    AND act.standard_type = 'IC50'
    AND act.standard_units = 'nM'
LIMIT 100;
```</p>
<p><strong>V√≠ d·ª• 2: Python - T√≠nh to√°n s·ªë l∆∞·ª£ng v√≤ng (Calculating Number of Rings)</strong></p>
<p>```python</p>
<h1>English: Python code to calculate the number of rings in each molecule</h1>
<h1>Vietnamese: M√£ Python ƒë·ªÉ t√≠nh to√°n s·ªë l∆∞·ª£ng v√≤ng trong m·ªói ph√¢n t·ª≠</h1>
<p>import pandas as pd
from rdkit import Chem
from rdkit.Chem import rdMolDescriptors
import os</p>
<h1>Define base path</h1>
<p>base_path = "../data"  # Adjust this to your actual base path</p>
<h1>Construct the file path</h1>
<p>csv_file_path = os.path.join(base_path, "your_extracted_data.csv") # Replace "your_extracted_data.csv" with your actual file name</p>
<h1>Read the CSV file</h1>
<p>try:
    df = pd.read_csv(csv_file_path)
    print("CSV file loaded successfully.")
except FileNotFoundError:
    print(f"Error: File not found at {csv_file_path}")
    exit()</p>
<p>def calculate_num_rings(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol:
            return rdMolDescriptors.CalcNumRings(mol)
        else:
            return None
    except:
        return None</p>
<p>df['num_rings'] = df['canonical_smiles'].apply(calculate_num_rings)</p>
<p>print(df[['chembl_id', 'canonical_smiles', 'num_rings']].head())
```</p>
<p><strong>V√≠ d·ª• 3: SQL - L·ªçc theo lo·∫°i ho·∫°t t√≠nh (Filtering by activity type kh√°c IC50)</strong></p>
<p>```sql
-- English: SQL query to filter compounds with Ki values
-- Vietnamese: Truy v·∫•n SQL ƒë·ªÉ l·ªçc c√°c h·ª£p ch·∫•t c√≥ gi√° tr·ªã Ki</p>
<p>SELECT
    md.chembl_id,
    cs.canonical_smiles,
    act.standard_value
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'Ki'
    AND act.standard_units = 'nM'
LIMIT 100;
```</p>
<p><strong>V√≠ d·ª• 3: Python - T√≠nh to√°n ch·ªâ s·ªë Topological Polar Surface Area (TPSA)</strong></p>
<p>```python</p>
<h1>English: Python code to calculate TPSA using RDKit</h1>
<h1>Vietnamese: M√£ Python ƒë·ªÉ t√≠nh to√°n TPSA s·ª≠ d·ª•ng RDKit</h1>
<p>import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import os</p>
<h1>Define base path</h1>
<p>base_path = "../data"  # Adjust this to your actual base path</p>
<h1>Construct the file path</h1>
<p>csv_file_path = os.path.join(base_path, "your_extracted_data.csv") # Replace "your_extracted_data.csv" with your actual file name</p>
<h1>Read the CSV file</h1>
<p>try:
    df = pd.read_csv(csv_file_path)
    print("CSV file loaded successfully.")
except FileNotFoundError:
    print(f"Error: File not found at {csv_file_path}")
    exit()</p>
<p>def calculate_tpsa(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol:
            return Descriptors.TPSA(mol)
        else:
            return None
    except:
        return None</p>
<p>df['tpsa'] = df['canonical_smiles'].apply(calculate_tpsa)</p>
<p>print(df[['chembl_id', 'canonical_smiles', 'tpsa']].head())
```</p>
<p><strong>V√≠ d·ª• 4: SQL - K·∫øt h·ª£p d·ªØ li·ªáu t·ª´ nhi·ªÅu b·∫£ng (Joining data from multiple tables)</strong></p>
<p>```sql
-- English: SQL query to join molecule_dictionary, compound_structures, activities, and target_dictionary tables
-- Vietnamese: Truy v·∫•n SQL ƒë·ªÉ k·∫øt h·ª£p c√°c b·∫£ng molecule_dictionary, compound_structures, activities v√† target_dictionary</p>
<p>SELECT
    md.chembl_id,
    cs.canonical_smiles,
    act.standard_type,
    act.standard_value,
    td.pref_name AS target_name
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
JOIN
    target_dictionary td ON act.tid = td.tid
WHERE
    act.standard_type = 'IC50'
    AND act.standard_units = 'nM'
LIMIT 100;
```</p>
<p><strong>V√≠ d·ª• 4: Python - Ph√¢n t√≠ch th·ªëng k√™ m√¥ t·∫£ (Descriptive statistics analysis)</strong></p>
<p>```python</p>
<h1>English: Python code for descriptive statistics analysis of activity data</h1>
<h1>Vietnamese: M√£ Python ƒë·ªÉ ph√¢n t√≠ch th·ªëng k√™ m√¥ t·∫£ d·ªØ li·ªáu ho·∫°t t√≠nh</h1>
<p>import pandas as pd
import os</p>
<h1>Define base path</h1>
<p>base_path = "../data"  # Adjust this to your actual base path</p>
<h1>Construct the file path</h1>
<p>csv_file_path = os.path.join(base_path, "your_extracted_data.csv") # Replace "your_extracted_data.csv" with your actual file name</p>
<h1>Read the CSV file</h1>
<p>try:
    df = pd.read_csv(csv_file_path)
    print("CSV file loaded successfully.")
except FileNotFoundError:
    print(f"Error: File not found at {csv_file_path}")
    exit()</p>
<h1>Convert standard_value to numeric, errors='coerce' will replace invalid parsing into NaN</h1>
<p>df['standard_value'] = pd.to_numeric(df['standard_value'], errors='coerce')</p>
<h1>Remove rows where 'standard_value' is NaN</h1>
<p>df = df.dropna(subset=['standard_value'])</p>
<h1>Perform descriptive statistics</h1>
<p>print(df['standard_value'].describe())</p>
<h1>Group by standard_type and calculate mean</h1>
<p>print(df.groupby('standard_type')['standard_value'].mean())</p>
<p>```</p>
<p><strong>V√≠ d·ª• 5: SQL - T√≠nh s·ªë l∆∞·ª£ng h·ª£p ch·∫•t cho m·ªói m·ª•c ti√™u (Counting compounds per target)</strong></p>
<p>```sql
-- English: SQL query to count the number of compounds for each target
-- Vietnamese: Truy v·∫•n SQL ƒë·ªÉ ƒë·∫øm s·ªë l∆∞·ª£ng h·ª£p ch·∫•t cho m·ªói m·ª•c ti√™u</p>
<p>SELECT
    td.chembl_id AS target_chembl_id,
    td.pref_name AS target_name,
    COUNT(DISTINCT md.molregno) AS num_compounds
FROM
    target_dictionary td
JOIN
    activities act ON td.tid = act.tid
JOIN
    molecule_dictionary md ON act.molregno = md.molregno
WHERE
    act.standard_type = 'IC50'
    AND act.standard_units = 'nM'
GROUP BY
    td.chembl_id, td.pref_name
ORDER BY
    num_compounds DESC
LIMIT 100;
```</p>
<p><strong>V√≠ d·ª• 5: Python - Tr·ª±c quan h√≥a d·ªØ li·ªáu (Data visualization)</strong></p>
<p>```python</p>
<h1>English: Python code to visualize the distribution of molecular weights</h1>
<h1>Vietnamese: M√£ Python ƒë·ªÉ tr·ª±c quan h√≥a s·ª± ph√¢n b·ªë c·ªßa tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠</h1>
<p>import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import os</p>
<h1>Define base path</h1>
<p>base_path = "../data"  # Adjust this to your actual base path</p>
<h1>Construct the file path</h1>
<p>csv_file_path = os.path.join(base_path, "your_extracted_data.csv") # Replace "your_extracted_data.csv" with your actual file name</p>
<h1>Read the CSV file</h1>
<p>try:
    df = pd.read_csv(csv_file_path)
    print("CSV file loaded successfully.")
except FileNotFoundError:
    print(f"Error: File not found at {csv_file_path}")
    exit()</p>
<h1>Calculate molecular weight (if not already calculated)</h1>
<p>from rdkit import Chem
from rdkit.Chem import Descriptors</p>
<p>def calculate_mw(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol:
            return Descriptors.MolWt(mol)
        else:
            return None
    except:
        return None</p>
<p>if 'molecular_weight' not in df.columns:
    df['molecular_weight'] = df['canonical_smiles'].apply(calculate_mw)</p>
<h1>Drop NaN values in 'molecular_weight' column</h1>
<p>df = df.dropna(subset=['molecular_weight'])</p>
<h1>Create a histogram</h1>
<p>plt.figure(figsize=(10, 6))
sns.histplot(df['molecular_weight'], bins=30, kde=True)
plt.title('Distribution of Molecular Weights')
plt.xlabel('Molecular Weight')
plt.ylabel('Frequency')
plt.show()
```</p>
<p><strong>5. L∆∞u √Ω v·ªÅ l·ªói (Error Notes)</strong></p>
<ul>
<li><strong>L·ªói SQL:</strong> Nh∆∞ ƒë√£ gi·∫£i th√≠ch ·ªü tr√™n, b·∫°n c√≥ th·ªÉ lo·∫°i b·ªè ƒëi·ªÅu ki·ªán <code>act.standard_value ~ '^[0-9\.]+$'</code> ho·∫∑c √©p ki·ªÉu c·ªôt <code>act.standard_value</code> v·ªÅ ki·ªÉu text tr∆∞·ªõc khi s·ª≠ d·ª•ng to√°n t·ª≠ <code>~</code>.</li>
<li><strong>L·ªói Scikit-learn:</strong> N·∫øu b·∫°n ƒëang s·ª≠ d·ª•ng phi√™n b·∫£n Scikit-learn c≈©, h√£y c√¢n nh·∫Øc n√¢ng c·∫•p l√™n phi√™n b·∫£n m·ªõi h∆°n ho·∫∑c s·ª≠ d·ª•ng c√°c gi·∫£i ph√°p thay th·∫ø cho tham s·ªë <code>squared=False</code>. V√≠ d·ª•: b·∫°n c√≥ th·ªÉ t√≠nh cƒÉn b·∫≠c hai c·ªßa Mean Squared Error (MSE) ƒë·ªÉ c√≥ ƒë∆∞·ª£c Root Mean Squared Error (RMSE).</li>
</ul>
<p><strong>V√≠ d·ª• v·ªÅ c√°ch t√≠nh RMSE n·∫øu kh√¥ng c√≥ <code>squared=False</code>:</strong></p>
<p>```python
from sklearn.metrics import mean_squared_error
import numpy as np</p>
<h1>Example data</h1>
<p>y_true = [3, -0.5, 2, 7]
y_predicted = [2.5, 0.0, 2, 8]</p>
<h1>Calculate MSE</h1>
<p>mse = mean_squared_error(y_true, y_predicted)</p>
<h1>Calculate RMSE</h1>
<p>rmse = np.sqrt(mse)</p>
<p>print("MSE:", mse)
print("RMSE:", rmse)
```</p>
<p><strong>L·ªùi khuy√™n:</strong></p>
<ul>
<li><strong>Chia nh·ªè v·∫•n ƒë·ªÅ:</strong> B·∫Øt ƒë·∫ßu v·ªõi c√°c truy v·∫•n SQL v√† ƒëo·∫°n code Python ƒë∆°n gi·∫£n, sau ƒë√≥ d·∫ßn d·∫ßn tƒÉng ƒë·ªô ph·ª©c t·∫°p.</li>
<li><strong>Ki·ªÉm tra d·ªØ li·ªáu:</strong> Lu√¥n ki·ªÉm tra d·ªØ li·ªáu c·ªßa b·∫°n sau m·ªói b∆∞·ªõc ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng n√≥ ƒë√∫ng v√† h·ª£p l·ªá.</li>
<li><strong>T√†i li·ªáu h√≥a:</strong> Ghi l·∫°i c√°c b∆∞·ªõc b·∫°n th·ª±c hi·ªán v√† c√°c quy·∫øt ƒë·ªãnh b·∫°n ƒë∆∞a ra ƒë·ªÉ gi√∫p b·∫°n v√† ng∆∞·ªùi kh√°c hi·ªÉu ƒë∆∞·ª£c quy tr√¨nh l√†m vi·ªác c·ªßa b·∫°n.</li>
<li><strong>S·ª≠ d·ª•ng m√¥i tr∆∞·ªùng ·∫£o:</strong> T·∫°o m·ªôt m√¥i tr∆∞·ªùng ·∫£o ƒë·ªÉ qu·∫£n l√Ω c√°c g√≥i Python c·ªßa b·∫°n v√† tr√°nh xung ƒë·ªôt.</li>
<li><strong>Phi√™n b·∫£n h√≥a m√£:</strong> S·ª≠ d·ª•ng Git ƒë·ªÉ theo d√µi c√°c thay ƒë·ªïi c·ªßa b·∫°n v√† c·ªông t√°c v·ªõi ng∆∞·ªùi kh√°c.</li>
</ul>
<p>Ch√∫c b·∫°n th√†nh c√¥ng v·ªõi d·ª± √°n c·ªßa m√¨nh! N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi n√†o kh√°c, ƒë·ª´ng ng·∫ßn ng·∫°i h·ªèi.</p>
        </body>
        </html>
        
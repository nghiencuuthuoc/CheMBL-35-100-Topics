
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Topic_CheMBL_35_25</title>
            <style>
                body {
                    font-family: "Georgia", serif;
                    max-width: 800px;
                    margin: 40px auto;
                    padding: 20px;
                    line-height: 1.6;
                    background-color: #ffffff;
                    color: #333;
                }
                h1, h2, h3 {
                    color: #1a1a1a;
                }
                code {
                    background-color: #f5f5f5;
                    padding: 2px 4px;
                    border-radius: 4px;
                }
                pre {
                    background-color: #f5f5f5;
                    padding: 10px;
                    overflow-x: auto;
                    border-radius: 6px;
                }
            </style>
        </head>
        <body>
        <h1>PharmApp Suite</h1>
<h2>üß† AI for Drug Discovery and Development üß™</h2>
<p>| Copyright 2025 | Nghi√™n C·ª©u Thu·ªëc | www.nghiencuuthuoc.comlus | Zalo: +84888999311 |</p>
<h1>üß© Topic: L·∫≠p h·ªì s∆° ligand ƒëa ƒë√≠ch</h1>
<hr />
<p>Tuy·ªát v·ªùi! T√¥i r·∫•t vui ƒë∆∞·ª£c h·ªó tr·ª£ b·∫°n trong d·ª± √°n ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL 35 n√†y. V·ªõi kinh nghi·ªám trong lƒ©nh v·ª±c nghi√™n c·ª©u v√† ph√°t tri·ªÉn d∆∞·ª£c h·ªçc, t√¥i s·∫Ω gi√∫p b·∫°n x√¢y d·ª±ng m·ªôt quy tr√¨nh l√†m vi·ªác hi·ªáu qu·∫£, t·ª´ truy v·∫•n SQL ƒë·∫øn ph√¢n t√≠ch d·ªØ li·ªáu b·∫±ng Python v√† RDKit.</p>
<p><strong>1. Ph√¢n t√≠ch M√¥ h√¨nh Ph√¢n t√≠ch (Analysis of the Analysis Model)</strong></p>
<p>D·ª±a tr√™n th√¥ng tin b·∫°n cung c·∫•p, ch√∫ng ta s·∫Ω th·ª±c hi·ªán m·ªôt quy tr√¨nh ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL 35 theo c√°c b∆∞·ªõc sau:</p>
<ul>
<li><strong>Thu th·∫≠p d·ªØ li·ªáu (Data Acquisition):</strong> S·ª≠ d·ª•ng SQL ƒë·ªÉ truy v·∫•n c∆° s·ªü d·ªØ li·ªáu ChEMBL 35 v√† tr√≠ch xu·∫•t th√¥ng tin c·∫ßn thi·∫øt, l∆∞u tr·ªØ d∆∞·ªõi d·∫°ng file CSV.</li>
<li><strong>Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu (Data Preprocessing):</strong><ul>
<li>L√†m s·∫°ch d·ªØ li·ªáu: Lo·∫°i b·ªè c√°c gi√° tr·ªã null, x·ª≠ l√Ω c√°c gi√° tr·ªã ngo·∫°i l·ªá.</li>
<li>Chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu: Chuy·ªÉn ƒë·ªïi c√°c gi√° tr·ªã ho·∫°t t√≠nh (activity values) v·ªÅ d·∫°ng s·ªë, chu·∫©n h√≥a d·ªØ li·ªáu (n·∫øu c·∫ßn).</li>
</ul>
</li>
<li><strong>Ph√¢n t√≠ch d·ªØ li·ªáu (Data Analysis):</strong><ul>
<li>T√≠nh to√°n c√°c thu·ªôc t√≠nh ph√¢n t·ª≠ (Molecular Properties): S·ª≠ d·ª•ng RDKit ƒë·ªÉ t√≠nh to√°n c√°c thu·ªôc t√≠nh v·∫≠t l√Ω h√≥a h·ªçc c·ªßa c√°c ph√¢n t·ª≠ (v√≠ d·ª•: LogP, MW, TPSA).</li>
<li>Ph√¢n t√≠ch t∆∞∆°ng quan (Correlation Analysis): X√°c ƒë·ªãnh m·ªëi t∆∞∆°ng quan gi·ªØa c√°c thu·ªôc t√≠nh ph√¢n t·ª≠ v√† ho·∫°t t√≠nh sinh h·ªçc.</li>
<li>X√¢y d·ª±ng m√¥ h√¨nh (Model Building): S·ª≠ d·ª•ng c√°c thu·∫≠t to√°n h·ªçc m√°y (v√≠ d·ª•: Linear Regression, Random Forest) ƒë·ªÉ x√¢y d·ª±ng m√¥ h√¨nh d·ª± ƒëo√°n ho·∫°t t√≠nh sinh h·ªçc d·ª±a tr√™n c√°c thu·ªôc t√≠nh ph√¢n t·ª≠.</li>
</ul>
</li>
<li><strong>ƒê√°nh gi√° m√¥ h√¨nh (Model Evaluation):</strong> ƒê√°nh gi√° hi·ªáu nƒÉng c·ªßa m√¥ h√¨nh b·∫±ng c√°c ch·ªâ s·ªë ph√π h·ª£p (v√≠ d·ª•: RMSE, R-squared).</li>
<li><strong>Tr·ª±c quan h√≥a d·ªØ li·ªáu (Data Visualization):</strong> S·ª≠ d·ª•ng c√°c bi·ªÉu ƒë·ªì ƒë·ªÉ tr·ª±c quan h√≥a k·∫øt qu·∫£ ph√¢n t√≠ch, gi√∫p d·ªÖ d√†ng nh·∫≠n bi·∫øt c√°c xu h∆∞·ªõng v√† m·ªëi quan h·ªá quan tr·ªçng.</li>
</ul>
<p><strong>2. H∆∞·ªõng d·∫´n song ng·ªØ (Bilingual Instructions)</strong></p>
<p>D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt b·∫±ng c·∫£ ti·∫øng Anh v√† ti·∫øng Vi·ªát cho t·ª´ng b∆∞·ªõc trong quy tr√¨nh ph√¢n t√≠ch:</p>
<p><strong>Step 1: Data Acquisition (B∆∞·ªõc 1: Thu th·∫≠p d·ªØ li·ªáu)</strong></p>
<ul>
<li><strong>English:</strong> Use SQL queries to extract relevant data from the ChEMBL 35 database (e.g., target information, compound structures, activity data). Save the results as CSV files.</li>
<li><strong>Ti·∫øng Vi·ªát:</strong> S·ª≠ d·ª•ng c√°c truy v·∫•n SQL ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu li√™n quan t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35 (v√≠ d·ª•: th√¥ng tin v·ªÅ ƒë√≠ch t√°c ƒë·ªông, c·∫•u tr√∫c h·ª£p ch·∫•t, d·ªØ li·ªáu ho·∫°t t√≠nh). L∆∞u k·∫øt qu·∫£ d∆∞·ªõi d·∫°ng file CSV.</li>
</ul>
<p><strong>Step 2: Data Preprocessing (B∆∞·ªõc 2: Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu)</strong></p>
<ul>
<li><strong>English:</strong> Clean the data by removing null values, handling outliers, and converting activity values to numerical format. Consider data normalization if necessary.</li>
<li><strong>Ti·∫øng Vi·ªát:</strong> L√†m s·∫°ch d·ªØ li·ªáu b·∫±ng c√°ch lo·∫°i b·ªè c√°c gi√° tr·ªã null, x·ª≠ l√Ω c√°c gi√° tr·ªã ngo·∫°i l·ªá v√† chuy·ªÉn ƒë·ªïi c√°c gi√° tr·ªã ho·∫°t t√≠nh v·ªÅ d·∫°ng s·ªë. C√¢n nh·∫Øc chu·∫©n h√≥a d·ªØ li·ªáu n·∫øu c·∫ßn thi·∫øt.</li>
</ul>
<p><strong>Step 3: Data Analysis (B∆∞·ªõc 3: Ph√¢n t√≠ch d·ªØ li·ªáu)</strong></p>
<ul>
<li><strong>English:</strong><ul>
<li>Calculate molecular properties using RDKit (e.g., LogP, MW, TPSA).</li>
<li>Perform correlation analysis to identify relationships between molecular properties and biological activity.</li>
<li>Build predictive models using machine learning algorithms (e.g., Linear Regression, Random Forest).</li>
</ul>
</li>
<li><strong>Ti·∫øng Vi·ªát:</strong><ul>
<li>T√≠nh to√°n c√°c thu·ªôc t√≠nh ph√¢n t·ª≠ b·∫±ng RDKit (v√≠ d·ª•: LogP, MW, TPSA).</li>
<li>Th·ª±c hi·ªán ph√¢n t√≠ch t∆∞∆°ng quan ƒë·ªÉ x√°c ƒë·ªãnh m·ªëi quan h·ªá gi·ªØa c√°c thu·ªôc t√≠nh ph√¢n t·ª≠ v√† ho·∫°t t√≠nh sinh h·ªçc.</li>
<li>X√¢y d·ª±ng c√°c m√¥ h√¨nh d·ª± ƒëo√°n b·∫±ng c√°ch s·ª≠ d·ª•ng c√°c thu·∫≠t to√°n h·ªçc m√°y (v√≠ d·ª•: Linear Regression, Random Forest).</li>
</ul>
</li>
</ul>
<p><strong>Step 4: Model Evaluation (B∆∞·ªõc 4: ƒê√°nh gi√° m√¥ h√¨nh)</strong></p>
<ul>
<li><strong>English:</strong> Evaluate the performance of the models using appropriate metrics (e.g., RMSE, R-squared).</li>
<li><strong>Ti·∫øng Vi·ªát:</strong> ƒê√°nh gi√° hi·ªáu nƒÉng c·ªßa c√°c m√¥ h√¨nh b·∫±ng c√°c ch·ªâ s·ªë ph√π h·ª£p (v√≠ d·ª•: RMSE, R-squared).</li>
</ul>
<p><strong>Step 5: Data Visualization (B∆∞·ªõc 5: Tr·ª±c quan h√≥a d·ªØ li·ªáu)</strong></p>
<ul>
<li><strong>English:</strong> Use plots and charts to visualize the analysis results and identify key trends and relationships.</li>
<li><strong>Ti·∫øng Vi·ªát:</strong> S·ª≠ d·ª•ng c√°c bi·ªÉu ƒë·ªì ƒë·ªÉ tr·ª±c quan h√≥a k·∫øt qu·∫£ ph√¢n t√≠ch v√† x√°c ƒë·ªãnh c√°c xu h∆∞·ªõng v√† m·ªëi quan h·ªá quan tr·ªçng.</li>
</ul>
<p><strong>3. Code SQL, Python (English)</strong></p>
<p><strong>SQL (to extract 100 rows of data):</strong></p>
<p><code>sql
-- SQL query to extract 100 rows of data from ChEMBL
SELECT
    md.molregno,
    cs.canonical_smiles,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE act.standard_type = 'IC50'  -- You can change activity type
LIMIT 100;</code></p>
<p><strong>Python (using RDKit and scikit-learn):</strong></p>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score</p>
<h1>Define base path</h1>
<p>base_path = "." # Replace with your actual base path</p>
<h1>Load data from CSV</h1>
<p>data_path = os.path.join(base_path, 'data', 'chembl_data.csv')  # Replace 'chembl_data.csv' with your file name
df = pd.read_csv(data_path)</p>
<h1>Data cleaning and conversion</h1>
<p>df = df.dropna(subset=['canonical_smiles', 'standard_value'])
df = df[df['standard_value'].astype(str).str.match(r'^[0-9.]+$')]  # Corrected regex
df['standard_value'] = pd.to_numeric(df['standard_value'], errors='coerce')
df = df.dropna(subset=['standard_value'])</p>
<h1>RDKit molecular descriptors calculation</h1>
<p>def calculate_descriptors(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None
    descriptors = {}
    descriptors['MolLogP'] = Descriptors.MolLogP(mol)
    descriptors['MolWt'] = Descriptors.MolWt(mol)
    descriptors['TPSA'] = Descriptors.TPSA(mol)
    return descriptors</p>
<p>df['descriptors'] = df['canonical_smiles'].apply(calculate_descriptors)
df = df.dropna(subset=['descriptors'])
df = df[df['descriptors'].apply(lambda x: isinstance(x, dict))]</p>
<h1>Convert descriptors to columns</h1>
<p>df = pd.concat([df.drop(['descriptors'], axis=1), df['descriptors'].apply(pd.Series)], axis=1)</p>
<h1>Prepare data for machine learning</h1>
<p>X = df[['MolLogP', 'MolWt', 'TPSA']]
y = np.log10(df['standard_value'])  # log transform IC50 values</p>
<h1>Data splitting</h1>
<p>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</p>
<h1>Model training</h1>
<p>model = LinearRegression()
model.fit(X_train, y_train)</p>
<h1>Model prediction</h1>
<p>y_pred = model.predict(X_test)</p>
<h1>Model evaluation</h1>
<p>mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)</p>
<p>print(f"Mean Squared Error: {mse}")
print(f"R-squared: {r2}")
```</p>
<p><strong>Important Notes:</strong></p>
<ul>
<li><strong>Error Handling (X·ª≠ l√Ω l·ªói):</strong>  The <code>dropna</code> and <code>astype(str).str.match(r'^[0-9\.]+$')</code> lines in the Python code address the potential issues with missing data and non-numeric activity values. The regular expression <code>^[0-9\.]+$</code> ensures that only strings containing numbers and periods are considered valid.</li>
<li><strong>Scikit-learn Version:</strong> If you encounter the error related to <code>squared=False</code> in <code>mean_squared_error</code>, either upgrade your scikit-learn version or remove the <code>squared=False</code> argument (the default behavior is <code>squared=True</code>).</li>
<li><strong>File Paths (ƒê∆∞·ªùng d·∫´n t·ªáp):</strong>  Remember to replace <code>"chembl_data.csv"</code> with the actual name of your CSV file and update the <code>base_path</code> variable to reflect your project directory structure.</li>
<li><strong>Activity Type (Lo·∫°i ho·∫°t t√≠nh):</strong>  The SQL query currently filters for <code>standard_type = 'IC50'</code>.  Adjust this condition based on the specific activity type you are interested in.</li>
<li><strong>Data Exploration (Kh√°m ph√° d·ªØ li·ªáu):</strong> Before building the model, it's highly recommended to explore the data using descriptive statistics and visualizations to gain a better understanding of the data distribution and potential relationships.</li>
</ul>
<p><strong>4. V√≠ d·ª• Code SQL v√† Python (SQL and Python Code Examples)</strong></p>
<p>Here are 5 examples demonstrating various SQL queries and Python data analysis techniques:</p>
<p><strong>SQL Examples:</strong></p>
<ol>
<li><strong>Extract compounds with specific substructure:</strong></li>
</ol>
<p><code>sql
-- Find compounds containing a specific substructure (using SMARTS pattern)
SELECT md.molregno, cs.canonical_smiles
FROM molecule_dictionary md
JOIN compound_structures cs ON md.molregno = cs.molregno
WHERE cs.canonical_smiles LIKE '%[CH3][OH]%';  -- Example: finds compounds containing methyl alcohol</code></p>
<ol>
<li><strong>Find target information for a specific protein:</strong></li>
</ol>
<p><code>sql
-- Find target information for a specific protein (e.g., by target name)
SELECT td.tid, td.pref_name, td.target_type
FROM target_dictionary td
WHERE td.pref_name LIKE '%Kinase%';</code></p>
<ol>
<li><strong>Get activity data for a specific compound:</strong></li>
</ol>
<p><code>sql
-- Get activity data for a specific compound (by molregno)
SELECT act.standard_type, act.standard_value, act.standard_units
FROM activities act
WHERE act.molregno = 727278; -- Replace with a valid molregno</code></p>
<ol>
<li><strong>Extract compounds with activity against a specific target:</strong></li>
</ol>
<p><code>sql
-- Extract compounds with activity against a specific target (using target_id)
SELECT md.molregno, cs.canonical_smiles, act.standard_type, act.standard_value
FROM molecule_dictionary md
JOIN compound_structures cs ON md.molregno = cs.molregno
JOIN activities act ON md.molregno = act.molregno
WHERE act.tid = 214; -- Replace with a valid target_id</code></p>
<ol>
<li><strong>Count number of compounds for each activity type:</strong>
<code>sql
-- Count the number of compounds for each activity type
SELECT standard_type, COUNT(*) AS compound_count
FROM activities
GROUP BY standard_type
ORDER BY compound_count DESC;</code></li>
</ol>
<p><strong>Python Examples:</strong></p>
<ol>
<li><strong>Calculate and visualize the distribution of molecular weight:</strong></li>
</ol>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import matplotlib.pyplot as plt</p>
<h1>Load data (replace with your actual data loading)</h1>
<p>data_path = os.path.join(base_path, 'data', 'chembl_data.csv')
df = pd.read_csv(data_path)
df = df.dropna(subset=['canonical_smiles']) # Drop rows with missing smiles</p>
<p>def calculate_mw(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None
    return Descriptors.MolWt(mol)</p>
<p>df['mol_weight'] = df['canonical_smiles'].apply(calculate_mw)
df = df.dropna(subset=['mol_weight']) # Drop rows where MW could not be calculated</p>
<p>plt.hist(df['mol_weight'], bins=50)
plt.xlabel('Molecular Weight')
plt.ylabel('Frequency')
plt.title('Distribution of Molecular Weight')
plt.show()
```</p>
<ol>
<li><strong>Calculate LogP and plot against activity:</strong></li>
</ol>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import matplotlib.pyplot as plt
import numpy as np</p>
<h1>Load data (replace with your actual data loading)</h1>
<p>data_path = os.path.join(base_path, 'data', 'chembl_data.csv')
df = pd.read_csv(data_path)
df = df.dropna(subset=['canonical_smiles', 'standard_value']) # Handle missing data
df = df[df['standard_value'].astype(str).str.match(r'^[0-9.]+$')] #Handle non numeric
df['standard_value'] = pd.to_numeric(df['standard_value'], errors='coerce') #Convert to numeric
df = df.dropna(subset=['standard_value']) #Drop NA values
def calculate_logp(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None
    return Descriptors.MolLogP(mol)</p>
<p>df['logp'] = df['canonical_smiles'].apply(calculate_logp)
df = df.dropna(subset=['logp'])</p>
<p>plt.scatter(df['logp'], np.log10(df['standard_value'])) # Log transform activity for better visualization
plt.xlabel('LogP')
plt.ylabel('Log10(Activity)')
plt.title('LogP vs. Activity')
plt.show()
```</p>
<ol>
<li><strong>Calculate TPSA and filter compounds based on TPSA value:</strong></li>
</ol>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors</p>
<h1>Load data (replace with your actual data loading)</h1>
<p>data_path = os.path.join(base_path, 'data', 'chembl_data.csv')
df = pd.read_csv(data_path)
df = df.dropna(subset=['canonical_smiles']) # Handle missing data</p>
<p>def calculate_tpsa(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None
    return Descriptors.TPSA(mol)</p>
<p>df['tpsa'] = df['canonical_smiles'].apply(calculate_tpsa)
df = df.dropna(subset=['tpsa'])</p>
<h1>Filter compounds with TPSA less than 100</h1>
<p>filtered_df = df[df['tpsa'] &lt; 100]
print(f"Number of compounds with TPSA &lt; 100: {len(filtered_df)}")
```</p>
<ol>
<li><strong>Create a function to convert SMILES to Mol object and handle errors:</strong></li>
</ol>
<p>```python
from rdkit import Chem</p>
<p>def smiles_to_mol(smiles):
    """
    Converts a SMILES string to an RDKit Mol object, handling potential errors.</p>
<pre><code>Args:
    smiles (str): The SMILES string.

Returns:
    Chem.Mol: The RDKit Mol object, or None if an error occurred.
"""
try:
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        print(f"Warning: Could not create Mol object from SMILES: {smiles}")
        return None
    return mol
except Exception as e:
    print(f"Error processing SMILES {smiles}: {e}")
    return None
</code></pre>
<h1>Example usage:</h1>
<p>smiles_list = ['CC(=O)Oc1ccccc1C(=O)O', 'Invalid SMILES']
mol_objects = [smiles_to_mol(s) for s in smiles_list]
print(mol_objects)
```</p>
<ol>
<li><strong>Calculate multiple descriptors at once:</strong></li>
</ol>
<p>```python
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import numpy as np</p>
<h1>Load data (replace with your actual data loading)</h1>
<p>data_path = os.path.join(base_path, 'data', 'chembl_data.csv')
df = pd.read_csv(data_path)
df = df.dropna(subset=['canonical_smiles']) # Handle missing data</p>
<p>def calculate_descriptors(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None
    return pd.Series({
        'MolLogP': Descriptors.MolLogP(mol),
        'MolWt': Descriptors.MolWt(mol),
        'TPSA': Descriptors.TPSA(mol),
        'HBA': Descriptors.NumHAcceptors(mol),
        'HBD': Descriptors.NumHDonors(mol)
    })</p>
<p>df = pd.concat([df, df['canonical_smiles'].apply(calculate_descriptors)], axis=1)
print(df.head())
```</p>
<p>Remember to install the necessary libraries (<code>pandas</code>, <code>rdkit</code>, <code>scikit-learn</code>, <code>matplotlib</code>) using <code>pip install pandas rdkit scikit-learn matplotlib</code>.</p>
<p>This comprehensive guide, along with the code examples, should provide a solid foundation for your ChEMBL 35 data analysis project. Please let me know if you have any further questions or need more specific assistance. Good luck!</p>
        </body>
        </html>
        
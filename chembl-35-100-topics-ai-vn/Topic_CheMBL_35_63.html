
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Topic_CheMBL_35_63</title>
            <style>
                body {
                    font-family: "Georgia", serif;
                    max-width: 800px;
                    margin: 40px auto;
                    padding: 20px;
                    line-height: 1.6;
                    background-color: #ffffff;
                    color: #333;
                }
                h1, h2, h3 {
                    color: #1a1a1a;
                }
                code {
                    background-color: #f5f5f5;
                    padding: 2px 4px;
                    border-radius: 4px;
                }
                pre {
                    background-color: #f5f5f5;
                    padding: 10px;
                    overflow-x: auto;
                    border-radius: 6px;
                }
            </style>
        </head>
        <body>
        <h1>PharmApp Suite</h1>
<h2>üß† AI for Drug Discovery and Development üß™</h2>
<p>| Copyright 2025 | Nghi√™n C·ª©u Thu·ªëc | www.nghiencuuthuoc.comlus | Zalo: +84888999311 |</p>
<h1>üß© Topic: T·ªëi ∆∞u h√≥a XGBoost ƒë·ªÉ d·ª± ƒëo√°n IC50</h1>
<hr />
<p>Tuy·ªát v·ªùi! T√¥i r·∫•t vui ƒë∆∞·ª£c h·ªó tr·ª£ b·∫°n trong d·ª± √°n ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL 35 s·ª≠ d·ª•ng RDKit. V·ªõi vai tr√≤ l√† m·ªôt chuy√™n gia R&amp;D d∆∞·ª£c h·ªçc, t√¥i s·∫Ω cung c·∫•p cho b·∫°n h∆∞·ªõng d·∫´n chi ti·∫øt, code m·∫´u v√† c√°c ph√¢n t√≠ch c·∫ßn thi·∫øt ƒë·ªÉ b·∫°n c√≥ th·ªÉ tri·ªÉn khai d·ª± √°n m·ªôt c√°ch hi·ªáu qu·∫£.</p>
<p><strong>T·ªïng quan v·ªÅ d·ª± √°n</strong></p>
<p>D·ª± √°n c·ªßa b·∫°n t·∫≠p trung v√†o vi·ªác khai th√°c d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35, m·ªôt ngu·ªìn t√†i nguy√™n v√¥ gi√° cho vi·ªác nghi√™n c·ª©u v√† ph√°t tri·ªÉn thu·ªëc. B·∫±ng c√°ch k·∫øt h·ª£p ChEMBL v·ªõi RDKit, m·ªôt toolkit m√£ ngu·ªìn m·ªü m·∫°nh m·∫Ω cho tin sinh h·ªçc v√† h√≥a tin h·ªçc, b·∫°n c√≥ th·ªÉ th·ª±c hi·ªán c√°c ph√¢n t√≠ch ph·ª©c t·∫°p v·ªÅ c·∫•u tr√∫c h√≥a h·ªçc, ho·∫°t t√≠nh sinh h·ªçc v√† m·ªëi quan h·ªá c·∫•u tr√∫c-ho·∫°t t√≠nh (SAR).</p>
<p><strong>Ph√¢n t√≠ch m√¥ h√¨nh</strong></p>
<p>M√¥ h√¨nh ph√¢n t√≠ch c·ªßa b·∫°n s·∫Ω bao g·ªìm c√°c b∆∞·ªõc sau:</p>
<ol>
<li><strong>Tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ ChEMBL:</strong> S·ª≠ d·ª•ng SQL ƒë·ªÉ truy v·∫•n v√† tr√≠ch xu·∫•t d·ªØ li·ªáu li√™n quan ƒë·∫øn c√°c h·ª£p ch·∫•t v√† ho·∫°t t√≠nh sinh h·ªçc c·ªßa ch√∫ng t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35.</li>
<li><strong>Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu:</strong> L√†m s·∫°ch v√† chu·∫©n h√≥a d·ªØ li·ªáu, lo·∫°i b·ªè c√°c gi√° tr·ªã thi·∫øu ho·∫∑c kh√¥ng h·ª£p l·ªá.</li>
<li><strong>T√≠nh to√°n ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠:</strong> S·ª≠ d·ª•ng RDKit ƒë·ªÉ t√≠nh to√°n c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ (molecular descriptors) t·ª´ c·∫•u tr√∫c h√≥a h·ªçc c·ªßa c√°c h·ª£p ch·∫•t. C√°c ƒë·∫∑c tr∆∞ng n√†y c√≥ th·ªÉ bao g·ªìm c√°c thu·ªôc t√≠nh v·∫≠t l√Ω h√≥a h·ªçc, topo, h√¨nh h·ªçc v√† ƒëi·ªán t·ª≠.</li>
<li><strong>Ph√¢n t√≠ch SAR:</strong> √Åp d·ª•ng c√°c ph∆∞∆°ng ph√°p th·ªëng k√™ v√† h·ªçc m√°y ƒë·ªÉ x√°c ƒë·ªãnh m·ªëi quan h·ªá gi·ªØa c·∫•u tr√∫c h√≥a h·ªçc v√† ho·∫°t t√≠nh sinh h·ªçc. V√≠ d·ª•: b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng h·ªìi quy tuy·∫øn t√≠nh, c√¢y quy·∫øt ƒë·ªãnh ho·∫∑c m·∫°ng n∆°-ron ƒë·ªÉ x√¢y d·ª±ng c√°c m√¥ h√¨nh d·ª± ƒëo√°n ho·∫°t t√≠nh d·ª±a tr√™n c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠.</li>
<li><strong>Tr·ª±c quan h√≥a k·∫øt qu·∫£:</strong> S·ª≠ d·ª•ng c√°c c√¥ng c·ª• tr·ª±c quan h√≥a d·ªØ li·ªáu ƒë·ªÉ tr√¨nh b√†y k·∫øt qu·∫£ ph√¢n t√≠ch m·ªôt c√°ch r√µ r√†ng v√† d·ªÖ hi·ªÉu. V√≠ d·ª•: b·∫°n c√≥ th·ªÉ t·∫°o c√°c bi·ªÉu ƒë·ªì ph√¢n t√°n, bi·ªÉu ƒë·ªì h·ªôp ho·∫∑c b·∫£n ƒë·ªì nhi·ªát ƒë·ªÉ kh√°m ph√° c√°c xu h∆∞·ªõng v√† m·ªëi quan h·ªá trong d·ªØ li·ªáu.</li>
</ol>
<p><strong>H∆∞·ªõng d·∫´n song ng·ªØ v√† code m·∫´u</strong></p>
<p>D∆∞·ªõi ƒë√¢y l√† c√°c v√≠ d·ª• v·ªÅ code SQL v√† Python, k√®m theo gi·∫£i th√≠ch chi ti·∫øt b·∫±ng c·∫£ ti·∫øng Anh v√† ti·∫øng Vi·ªát:</p>
<p><strong>1. Tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ ChEMBL (SQL)</strong></p>
<p><code>sql
-- SQL query to extract data from ChEMBL database
-- Truy v·∫•n SQL ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL
SELECT
    md.molregno,
    cs.canonical_smiles,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'IC50'
    AND act.standard_units = 'nM'
    AND act.standard_value IS NOT NULL
    AND act.standard_value ~ '^[0-9\.]+$' -- L·ªçc gi√° tr·ªã s·ªë
LIMIT 100;</code></p>
<p><strong>Gi·∫£i th√≠ch:</strong></p>
<ul>
<li><strong>SELECT:</strong> Ch·ªçn c√°c c·ªôt <code>molregno</code>, <code>canonical_smiles</code>, <code>standard_type</code>, <code>standard_value</code> v√† <code>standard_units</code> t·ª´ c√°c b·∫£ng <code>molecule_dictionary</code>, <code>compound_structures</code> v√† <code>activities</code>.</li>
<li><strong>FROM:</strong> Ch·ªâ ƒë·ªãnh c√°c b·∫£ng ƒë·ªÉ truy v·∫•n.</li>
<li><strong>JOIN:</strong> K·∫øt h·ª£p c√°c b·∫£ng d·ª±a tr√™n kh√≥a ngo·∫°i <code>molregno</code>.</li>
<li><strong>WHERE:</strong> L·ªçc d·ªØ li·ªáu d·ª±a tr√™n c√°c ƒëi·ªÅu ki·ªán sau:<ul>
<li><code>act.standard_type = 'IC50'</code>: Ch·ªâ ch·ªçn c√°c ho·∫°t t√≠nh c√≥ lo·∫°i l√† IC50.</li>
<li><code>act.standard_units = 'nM'</code>: Ch·ªâ ch·ªçn c√°c ho·∫°t t√≠nh c√≥ ƒë∆°n v·ªã l√† nM.</li>
<li><code>act.standard_value IS NOT NULL</code>: Lo·∫°i b·ªè c√°c gi√° tr·ªã <code>standard_value</code> b·ªã thi·∫øu.</li>
<li><code>act.standard_value ~ '^[0-9\.]+$'</code>: Ch·ªâ ch·ªçn c√°c gi√° tr·ªã <code>standard_value</code> l√† s·ªë.</li>
</ul>
</li>
<li><strong>LIMIT 100:</strong> Gi·ªõi h·∫°n s·ªë l∆∞·ª£ng k·∫øt qu·∫£ tr·∫£ v·ªÅ l√† 100 d√≤ng.</li>
</ul>
<p><strong>Explanation:</strong></p>
<ul>
<li><strong>SELECT:</strong> Selects the <code>molregno</code>, <code>canonical_smiles</code>, <code>standard_type</code>, <code>standard_value</code>, and <code>standard_units</code> columns from the <code>molecule_dictionary</code>, <code>compound_structures</code>, and <code>activities</code> tables.</li>
<li><strong>FROM:</strong> Specifies the tables to query.</li>
<li><strong>JOIN:</strong> Joins the tables based on the foreign key <code>molregno</code>.</li>
<li><strong>WHERE:</strong> Filters the data based on the following conditions:<ul>
<li><code>act.standard_type = 'IC50'</code>: Only selects activities with type IC50.</li>
<li><code>act.standard_units = 'nM'</code>: Only selects activities with units nM.</li>
<li><code>act.standard_value IS NOT NULL</code>: Removes missing <code>standard_value</code> values.</li>
<li><code>act.standard_value ~ '^[0-9\.]+$'</code>: Only selects <code>standard_value</code> values that are numeric.</li>
</ul>
</li>
<li><strong>LIMIT 100:</strong> Limits the number of results returned to 100 rows.</li>
</ul>
<p><strong>S·ª≠a l·ªói:</strong></p>
<p>L·ªói <code>ERROR: operator does not exist: numeric ~ unknown</code> x·∫£y ra do b·∫°n ƒëang c·ªë g·∫Øng so s√°nh m·ªôt c·ªôt ki·ªÉu s·ªë (<code>numeric</code>) v·ªõi m·ªôt chu·ªói (<code>unknown</code>). ƒê·ªÉ kh·∫Øc ph·ª•c, b·∫°n c√≥ th·ªÉ √©p ki·ªÉu c·ªôt <code>standard_value</code> sang ki·ªÉu vƒÉn b·∫£n tr∆∞·ªõc khi th·ª±c hi·ªán so s√°nh:</p>
<p><code>sql
AND CAST(act.standard_value AS TEXT) ~ '^[0-9\.]+$'</code></p>
<p><strong>2. Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu v√† t√≠nh to√°n ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ (Python)</strong></p>
<p>```python</p>
<h1>Python code to preprocess data and calculate molecular descriptors using RDKit</h1>
<h1>M√£ Python ƒë·ªÉ ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu v√† t√≠nh to√°n c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ b·∫±ng RDKit</h1>
<p>import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
import numpy as np</p>
<h1>Define the base path</h1>
<h1>X√°c ƒë·ªãnh ƒë∆∞·ªùng d·∫´n g·ªëc</h1>
<p>base_path = "../data"</p>
<h1>Read the data from the CSV file</h1>
<h1>ƒê·ªçc d·ªØ li·ªáu t·ª´ file CSV</h1>
<p>csv_file = os.path.join(base_path, "chembl_ic50_data.csv") # Thay ƒë·ªïi t√™n file cho ph√π h·ª£p
data = pd.read_csv(csv_file)</p>
<h1>Function to calculate molecular descriptors</h1>
<h1>H√†m t√≠nh to√°n c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠</h1>
<p>def calculate_descriptors(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is not None:
        descriptors = {}
        descriptors['MolecularWeight'] = Descriptors.MolWt(mol)
        descriptors['LogP'] = Descriptors.MolLogP(mol)
        descriptors['HBD'] = Descriptors.NumHDonors(mol)
        descriptors['HBA'] = Descriptors.NumHAcceptors(mol)
        return descriptors
    else:
        return None</p>
<h1>Apply the function to each SMILES string</h1>
<h1>√Åp d·ª•ng h√†m cho m·ªói chu·ªói SMILES</h1>
<p>data['descriptors'] = data['canonical_smiles'].apply(calculate_descriptors)</p>
<h1>Convert descriptors to columns</h1>
<h1>Chuy·ªÉn ƒë·ªïi c√°c ƒë·∫∑c tr∆∞ng th√†nh c√°c c·ªôt</h1>
<p>data = pd.concat([data.drop(['descriptors'], axis=1), data['descriptors'].apply(pd.Series)], axis=1)</p>
<h1>Clean up data (remove rows with missing descriptors)</h1>
<h1>L√†m s·∫°ch d·ªØ li·ªáu (lo·∫°i b·ªè c√°c h√†ng c√≥ ƒë·∫∑c tr∆∞ng b·ªã thi·∫øu)</h1>
<p>data = data.dropna(subset=['MolecularWeight', 'LogP', 'HBD', 'HBA'])</p>
<h1>Display the first few rows of the processed data</h1>
<h1>Hi·ªÉn th·ªã m·ªôt v√†i h√†ng ƒë·∫ßu ti√™n c·ªßa d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω</h1>
<p>print(data.head())
```</p>
<p><strong>Gi·∫£i th√≠ch:</strong></p>
<ul>
<li><strong>Import libraries:</strong> Nh·∫≠p c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt, bao g·ªìm <code>pandas</code> ƒë·ªÉ thao t√°c d·ªØ li·ªáu, <code>rdkit</code> ƒë·ªÉ t√≠nh to√°n ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ v√† <code>numpy</code> cho c√°c ph√©p to√°n s·ªë h·ªçc.</li>
<li><strong>Read data:</strong> ƒê·ªçc d·ªØ li·ªáu t·ª´ file CSV ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc b·∫±ng SQL.</li>
<li><strong><code>calculate_descriptors</code> function:</strong> H√†m n√†y nh·∫≠n m·ªôt chu·ªói SMILES l√†m ƒë·∫ßu v√†o, t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng ph√¢n t·ª≠ t·ª´ chu·ªói SMILES b·∫±ng RDKit, v√† t√≠nh to√°n c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ nh∆∞ tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠ (<code>MolecularWeight</code>), h·ªá s·ªë ph√¢n v√πng octanol-n∆∞·ªõc (<code>LogP</code>), s·ªë l∆∞·ª£ng li√™n k·∫øt hydro cho (<code>HBD</code>) v√† nh·∫≠n (<code>HBA</code>).</li>
<li><strong>Apply function:</strong> √Åp d·ª•ng h√†m <code>calculate_descriptors</code> cho m·ªói chu·ªói SMILES trong c·ªôt <code>canonical_smiles</code> c·ªßa DataFrame.</li>
<li><strong>Convert descriptors to columns:</strong> Chuy·ªÉn ƒë·ªïi c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ th√†nh c√°c c·ªôt ri√™ng bi·ªát trong DataFrame.</li>
<li><strong>Clean up data:</strong> Lo·∫°i b·ªè c√°c h√†ng c√≥ gi√° tr·ªã ƒë·∫∑c tr∆∞ng b·ªã thi·∫øu.</li>
<li><strong>Display data:</strong> Hi·ªÉn th·ªã m·ªôt v√†i h√†ng ƒë·∫ßu ti√™n c·ªßa d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω.</li>
</ul>
<p><strong>Explanation:</strong></p>
<ul>
<li><strong>Import libraries:</strong> Imports the necessary libraries, including <code>pandas</code> for data manipulation, <code>rdkit</code> for calculating molecular descriptors, and <code>numpy</code> for numerical operations.</li>
<li><strong>Read data:</strong> Reads the data from the CSV file created in the previous step using SQL.</li>
<li><strong><code>calculate_descriptors</code> function:</strong> This function takes a SMILES string as input, creates a molecule object from the SMILES string using RDKit, and calculates molecular descriptors such as molecular weight (<code>MolecularWeight</code>), octanol-water partition coefficient (<code>LogP</code>), number of hydrogen bond donors (<code>HBD</code>), and number of hydrogen bond acceptors (<code>HBA</code>).</li>
<li><strong>Apply function:</strong> Applies the <code>calculate_descriptors</code> function to each SMILES string in the <code>canonical_smiles</code> column of the DataFrame.</li>
<li><strong>Convert descriptors to columns:</strong> Converts the molecular descriptors into separate columns in the DataFrame.</li>
<li><strong>Clean up data:</strong> Removes rows with missing descriptor values.</li>
<li><strong>Display data:</strong> Displays the first few rows of the processed data.</li>
</ul>
<p><strong>S·ª≠a l·ªói:</strong></p>
<p>L·ªói <code>TypeError: mean_squared_error() got an unexpected keyword argument 'squared'</code> x·∫£y ra do phi√™n b·∫£n scikit-learn b·∫°n ƒëang s·ª≠ d·ª•ng qu√° c≈© v√† kh√¥ng h·ªó tr·ª£ tham s·ªë <code>squared</code>. ƒê·ªÉ kh·∫Øc ph·ª•c, b·∫°n c√≥ th·ªÉ b·ªè tham s·ªë <code>squared</code> ho·∫∑c n√¢ng c·∫•p phi√™n b·∫£n scikit-learn c·ªßa m√¨nh.</p>
<p><strong>3. Ph√¢n t√≠ch SAR (Python)</strong></p>
<p>```python</p>
<h1>Python code for SAR analysis using scikit-learn</h1>
<h1>M√£ Python ƒë·ªÉ ph√¢n t√≠ch SAR b·∫±ng scikit-learn</h1>
<p>from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.preprocessing import StandardScaler</p>
<h1>Prepare the data</h1>
<h1>Chu·∫©n b·ªã d·ªØ li·ªáu</h1>
<p>X = data[['MolecularWeight', 'LogP', 'HBD', 'HBA']]
y = data['standard_value']</p>
<h1>Scale the features</h1>
<h1>Chu·∫©n h√≥a c√°c ƒë·∫∑c tr∆∞ng</h1>
<p>scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)</p>
<h1>Split the data into training and testing sets</h1>
<h1>Chia d·ªØ li·ªáu th√†nh t·∫≠p hu·∫•n luy·ªán v√† t·∫≠p ki·ªÉm tra</h1>
<p>X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)</p>
<h1>Create a linear regression model</h1>
<h1>T·∫°o m·ªôt m√¥ h√¨nh h·ªìi quy tuy·∫øn t√≠nh</h1>
<p>model = LinearRegression()</p>
<h1>Train the model</h1>
<h1>Hu·∫•n luy·ªán m√¥ h√¨nh</h1>
<p>model.fit(X_train, y_train)</p>
<h1>Make predictions on the test set</h1>
<h1>D·ª± ƒëo√°n tr√™n t·∫≠p ki·ªÉm tra</h1>
<p>y_pred = model.predict(X_test)</p>
<h1>Evaluate the model</h1>
<h1>ƒê√°nh gi√° m√¥ h√¨nh</h1>
<p>mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)</p>
<p>print(f"Mean Squared Error: {mse}")
print(f"R-squared: {r2}")
```</p>
<p><strong>Gi·∫£i th√≠ch:</strong></p>
<ul>
<li><strong>Import libraries:</strong> Nh·∫≠p c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt t·ª´ scikit-learn, bao g·ªìm <code>train_test_split</code> ƒë·ªÉ chia d·ªØ li·ªáu, <code>LinearRegression</code> ƒë·ªÉ x√¢y d·ª±ng m√¥ h√¨nh h·ªìi quy tuy·∫øn t√≠nh, <code>mean_squared_error</code> v√† <code>r2_score</code> ƒë·ªÉ ƒë√°nh gi√° m√¥ h√¨nh, v√† <code>StandardScaler</code> ƒë·ªÉ chu·∫©n h√≥a d·ªØ li·ªáu.</li>
<li><strong>Prepare data:</strong> Chu·∫©n b·ªã d·ªØ li·ªáu b·∫±ng c√°ch ch·ªçn c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ (<code>MolecularWeight</code>, <code>LogP</code>, <code>HBD</code>, <code>HBA</code>) l√†m bi·∫øn ƒë·ªôc l·∫≠p (X) v√† gi√° tr·ªã ho·∫°t t√≠nh (<code>standard_value</code>) l√†m bi·∫øn ph·ª• thu·ªôc (y).</li>
<li><strong>Scale features:</strong> Chu·∫©n h√≥a c√°c ƒë·∫∑c tr∆∞ng b·∫±ng <code>StandardScaler</code> ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ c√°c ƒë·∫∑c tr∆∞ng ƒë·ªÅu c√≥ c√πng t·ª∑ l·ªá.</li>
<li><strong>Split data:</strong> Chia d·ªØ li·ªáu th√†nh t·∫≠p hu·∫•n luy·ªán (80%) v√† t·∫≠p ki·ªÉm tra (20%).</li>
<li><strong>Create model:</strong> T·∫°o m·ªôt m√¥ h√¨nh h·ªìi quy tuy·∫øn t√≠nh.</li>
<li><strong>Train model:</strong> Hu·∫•n luy·ªán m√¥ h√¨nh tr√™n t·∫≠p hu·∫•n luy·ªán.</li>
<li><strong>Make predictions:</strong> D·ª± ƒëo√°n gi√° tr·ªã ho·∫°t t√≠nh tr√™n t·∫≠p ki·ªÉm tra.</li>
<li><strong>Evaluate model:</strong> ƒê√°nh gi√° m√¥ h√¨nh b·∫±ng c√°ch t√≠nh to√°n sai s·ªë b√¨nh ph∆∞∆°ng trung b√¨nh (<code>mse</code>) v√† h·ªá s·ªë x√°c ƒë·ªãnh (<code>r2</code>).</li>
</ul>
<p><strong>Explanation:</strong></p>
<ul>
<li><strong>Import libraries:</strong> Imports the necessary libraries from scikit-learn, including <code>train_test_split</code> for splitting the data, <code>LinearRegression</code> for building a linear regression model, <code>mean_squared_error</code> and <code>r2_score</code> for evaluating the model, and <code>StandardScaler</code> for scaling the data.</li>
<li><strong>Prepare data:</strong> Prepares the data by selecting the molecular descriptors (<code>MolecularWeight</code>, <code>LogP</code>, <code>HBD</code>, <code>HBA</code>) as independent variables (X) and the activity value (<code>standard_value</code>) as the dependent variable (y).</li>
<li><strong>Scale features:</strong> Scales the features using <code>StandardScaler</code> to ensure that all features are on the same scale.</li>
<li><strong>Split data:</strong> Splits the data into training (80%) and testing (20%) sets.</li>
<li><strong>Create model:</strong> Creates a linear regression model.</li>
<li><strong>Train model:</strong> Trains the model on the training set.</li>
<li><strong>Make predictions:</strong> Predicts the activity values on the test set.</li>
<li><strong>Evaluate model:</strong> Evaluates the model by calculating the mean squared error (<code>mse</code>) and the R-squared coefficient (<code>r2</code>).</li>
</ul>
<p><strong>4. Tr·ª±c quan h√≥a k·∫øt qu·∫£ (Python)</strong></p>
<p>```python</p>
<h1>Python code to visualize the results</h1>
<h1>M√£ Python ƒë·ªÉ tr·ª±c quan h√≥a k·∫øt qu·∫£</h1>
<p>import matplotlib.pyplot as plt</p>
<h1>Create a scatter plot of predicted vs. actual values</h1>
<h1>T·∫°o bi·ªÉu ƒë·ªì ph√¢n t√°n gi·ªØa gi√° tr·ªã d·ª± ƒëo√°n v√† gi√° tr·ªã th·ª±c t·∫ø</h1>
<p>plt.scatter(y_test, y_pred)
plt.xlabel("Actual IC50 (nM)")
plt.ylabel("Predicted IC50 (nM)")
plt.title("Actual vs. Predicted IC50 Values")
plt.show()
```</p>
<p><strong>5. V√≠ d·ª• code SQL v√† Python m·∫´u</strong></p>
<p>D∆∞·ªõi ƒë√¢y l√† 5 v√≠ d·ª• code SQL v√† Python m·∫´u ƒë·ªÉ b·∫°n tham kh·∫£o:</p>
<p><strong>V√≠ d·ª• 1: Tr√≠ch xu·∫•t d·ªØ li·ªáu v·ªÅ c√°c h·ª£p ch·∫•t c√≥ ho·∫°t t√≠nh ch·ªëng l·∫°i m·ªôt m·ª•c ti√™u c·ª• th·ªÉ (SQL)</strong></p>
<p><code>sql
-- SQL query to extract data for compounds active against a specific target
-- Truy v·∫•n SQL ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu cho c√°c h·ª£p ch·∫•t c√≥ ho·∫°t t√≠nh ch·ªëng l·∫°i m·ªôt m·ª•c ti√™u c·ª• th·ªÉ
SELECT
    md.molregno,
    cs.canonical_smiles,
    act.standard_value
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'IC50'
    AND act.standard_units = 'nM'
    AND act.target_chembl_id = 'CHEMBL205' -- Replace with the desired target ChEMBL ID
LIMIT 100;</code></p>
<p><strong>V√≠ d·ª• 2: T√≠nh to√°n s·ªë l∆∞·ª£ng v√≤ng trong ph√¢n t·ª≠ (Python)</strong></p>
<p>```python</p>
<h1>Python code to calculate the number of rings in a molecule</h1>
<h1>M√£ Python ƒë·ªÉ t√≠nh to√°n s·ªë l∆∞·ª£ng v√≤ng trong ph√¢n t·ª≠</h1>
<p>from rdkit import Chem
from rdkit.Chem import rdMolDescriptors</p>
<p>def calculate_num_rings(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is not None:
        return rdMolDescriptors.CalcNumRings(mol)
    else:
        return None</p>
<h1>Example usage</h1>
<h1>V√≠ d·ª• s·ª≠ d·ª•ng</h1>
<p>smiles = 'CC(=O)Oc1ccccc1C(=O)O'
num_rings = calculate_num_rings(smiles)
print(f"Number of rings in {smiles}: {num_rings}")
```</p>
<p><strong>V√≠ d·ª• 3: T√¨m c√°c h·ª£p ch·∫•t c√≥ tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠ n·∫±m trong m·ªôt kho·∫£ng nh·∫•t ƒë·ªãnh (SQL)</strong></p>
<p><code>sql
-- SQL query to find compounds with molecular weight within a certain range
-- Truy v·∫•n SQL ƒë·ªÉ t√¨m c√°c h·ª£p ch·∫•t c√≥ tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠ n·∫±m trong m·ªôt kho·∫£ng nh·∫•t ƒë·ªãnh
SELECT
    md.molregno,
    cs.canonical_smiles
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
WHERE
    md.mw_freebase BETWEEN 200 AND 400
LIMIT 100;</code></p>
<p><strong>V√≠ d·ª• 4: T√≠nh to√°n c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ b·ªï sung (Python)</strong></p>
<p>```python</p>
<h1>Python code to calculate additional molecular descriptors</h1>
<h1>M√£ Python ƒë·ªÉ t√≠nh to√°n c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ b·ªï sung</h1>
<p>from rdkit import Chem
from rdkit.Chem import Descriptors</p>
<p>def calculate_additional_descriptors(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is not None:
        descriptors = {}
        descriptors['TPSA'] = Descriptors.TPSA(mol) # Di·ªán t√≠ch b·ªÅ m·∫∑t ph√¢n c·ª±c topo
        descriptors['QED'] = Descriptors.qed(mol)   # Ch·∫•t l∆∞·ª£ng gi·ªëng thu·ªëc
        return descriptors
    else:
        return None
```</p>
<p><strong>V√≠ d·ª• 5: X√¢y d·ª±ng m√¥ h√¨nh d·ª± ƒëo√°n ho·∫°t t√≠nh b·∫±ng Random Forest (Python)</strong></p>
<p>```python</p>
<h1>Python code to build a Random Forest model for activity prediction</h1>
<h1>M√£ Python ƒë·ªÉ x√¢y d·ª±ng m√¥ h√¨nh Random Forest ƒë·ªÉ d·ª± ƒëo√°n ho·∫°t t√≠nh</h1>
<p>from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.preprocessing import StandardScaler
import pandas as pd</p>
<h1>Assuming 'data' DataFrame is already loaded and preprocessed</h1>
<h1>Gi·∫£ s·ª≠ DataFrame 'data' ƒë√£ ƒë∆∞·ª£c t·∫£i v√† ti·ªÅn x·ª≠ l√Ω</h1>
<h1>Prepare the data</h1>
<h1>Chu·∫©n b·ªã d·ªØ li·ªáu</h1>
<p>X = data[['MolecularWeight', 'LogP', 'HBD', 'HBA']]
y = data['standard_value']</p>
<h1>Scale the features</h1>
<h1>Chu·∫©n h√≥a c√°c ƒë·∫∑c tr∆∞ng</h1>
<p>scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)</p>
<h1>Split the data into training and testing sets</h1>
<h1>Chia d·ªØ li·ªáu th√†nh t·∫≠p hu·∫•n luy·ªán v√† t·∫≠p ki·ªÉm tra</h1>
<p>X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)</p>
<h1>Create a Random Forest model</h1>
<h1>T·∫°o m·ªôt m√¥ h√¨nh Random Forest</h1>
<p>model = RandomForestRegressor(n_estimators=100, random_state=42)</p>
<h1>Train the model</h1>
<h1>Hu·∫•n luy·ªán m√¥ h√¨nh</h1>
<p>model.fit(X_train, y_train)</p>
<h1>Make predictions on the test set</h1>
<h1>D·ª± ƒëo√°n tr√™n t·∫≠p ki·ªÉm tra</h1>
<p>y_pred = model.predict(X_test)</p>
<h1>Evaluate the model</h1>
<h1>ƒê√°nh gi√° m√¥ h√¨nh</h1>
<p>mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)</p>
<p>print(f"Mean Squared Error: {mse}")
print(f"R-squared: {r2}")
```</p>
<p><strong>L∆∞u √Ω quan tr·ªçng:</strong></p>
<ul>
<li>H√£y nh·ªõ thay ƒë·ªïi t√™n file CSV trong code Python cho ph√π h·ª£p v·ªõi t√™n file b·∫°n ƒë√£ l∆∞u.</li>
<li>B·∫°n c√≥ th·ªÉ t√πy ch·ªânh c√°c ƒë·∫∑c tr∆∞ng ph√¢n t·ª≠ ƒë∆∞·ª£c t√≠nh to√°n v√† c√°c tham s·ªë c·ªßa m√¥ h√¨nh h·ªçc m√°y ƒë·ªÉ ph√π h·ª£p v·ªõi m·ª•c ti√™u nghi√™n c·ª©u c·ªßa m√¨nh.</li>
<li>H√£y s·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p ƒë√°nh gi√° m√¥ h√¨nh ph√π h·ª£p ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng m√¥ h√¨nh c·ªßa b·∫°n c√≥ kh·∫£ nƒÉng d·ª± ƒëo√°n t·ªët tr√™n d·ªØ li·ªáu m·ªõi.</li>
</ul>
<p>Ch√∫c b·∫°n th√†nh c√¥ng v·ªõi d·ª± √°n c·ªßa m√¨nh! N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi n√†o kh√°c, ƒë·ª´ng ng·∫ßn ng·∫°i h·ªèi.</p>
        </body>
        </html>
        
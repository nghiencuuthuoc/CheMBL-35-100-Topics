
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Topic_CheMBL_35_37</title>
            <style>
                body {
                    font-family: "Georgia", serif;
                    max-width: 800px;
                    margin: 40px auto;
                    padding: 20px;
                    line-height: 1.6;
                    background-color: #ffffff;
                    color: #333;
                }
                h1, h2, h3 {
                    color: #1a1a1a;
                }
                code {
                    background-color: #f5f5f5;
                    padding: 2px 4px;
                    border-radius: 4px;
                }
                pre {
                    background-color: #f5f5f5;
                    padding: 10px;
                    overflow-x: auto;
                    border-radius: 6px;
                }
            </style>
        </head>
        <body>
        <h1>PharmApp Suite</h1>
<h2>üß† AI for Drug Discovery and Development üß™</h2>
<p>| Copyright 2025 | Nghi√™n C·ª©u Thu·ªëc | www.nghiencuuthuoc.comlus | Zalo: +84888999311 |</p>
<h1>üß© Topic: Khai th√°c target kh√°ng khu·∫©n t·ª´ ChEMBL</h1>
<hr />
<p>Tuy·ªát v·ªùi! T√¥i r·∫•t vui ƒë∆∞·ª£c tham gia v√†o d·ª± √°n th√∫ v·ªã n√†y v·ªõi vai tr√≤ Chuy√™n gia R&amp;D D∆∞·ª£c h·ªçc. Ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL b·∫±ng RDKit l√† m·ªôt h∆∞·ªõng ƒëi r·∫•t ti·ªÅm nƒÉng ƒë·ªÉ kh√°m ph√° v√† ph√°t tri·ªÉn c√°c lo·∫°i thu·ªëc m·ªõi.</p>
<p>D·ª±a tr√™n th√¥ng tin b·∫°n cung c·∫•p, t√¥i s·∫Ω x√¢y d·ª±ng m·ªôt quy tr√¨nh l√†m vi·ªác chi ti·∫øt, k√®m theo c√°c v√≠ d·ª• code v√† gi·∫£i th√≠ch c·∫∑n k·∫Ω, gi√∫p b·∫°n v∆∞·ª£t qua c√°c th√°ch th·ª©c v√† ƒë·∫°t ƒë∆∞·ª£c m·ª•c ti√™u c·ªßa d·ª± √°n.</p>
<p><strong>T·ªïng quan d·ª± √°n:</strong></p>
<p>D·ª± √°n n√†y t·∫≠p trung v√†o vi·ªác khai th√°c d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35, k·∫øt h·ª£p v·ªõi c√°c c√¥ng c·ª• tin sinh h·ªçc nh∆∞ RDKit, ƒë·ªÉ h·ªó tr·ª£ qu√° tr√¨nh nghi√™n c·ª©u v√† ph√°t tri·ªÉn thu·ªëc. Ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng SQL ƒë·ªÉ truy v·∫•n d·ªØ li·ªáu t·ª´ PostgreSQL v√† Python (v·ªõi RDKit) ƒë·ªÉ x·ª≠ l√Ω v√† ph√¢n t√≠ch d·ªØ li·ªáu.</p>
<p><strong>C·∫•u tr√∫c th∆∞ m·ª•c (theo chu·∫©n AIMLOps Template):</strong></p>
<p><code>project_root/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ *.csv  # D·ªØ li·ªáu xu·∫•t ra t·ª´ SQL
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ Topic_CheMBL_35_37_1_*.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ Topic_CheMBL_35_37_2_*.ipynb
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ ... (N·∫øu c√≥ code Python module)
‚îî‚îÄ‚îÄ ...</code></p>
<p><strong>1. Ph√¢n t√≠ch m√¥ h√¨nh ph√¢n t√≠ch (Analysis Model):</strong></p>
<p>Ch√∫ng ta c√≥ th·ªÉ √°p d·ª•ng nhi·ªÅu m√¥ h√¨nh ph√¢n t√≠ch kh√°c nhau, t√πy thu·ªôc v√†o c√¢u h·ªèi nghi√™n c·ª©u c·ª• th·ªÉ. D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë g·ª£i √Ω:</p>
<ul>
<li><strong>Ph√¢n t√≠ch t∆∞∆°ng quan c·∫•u tr√∫c-ho·∫°t t√≠nh (SAR/QSAR):</strong> X√¢y d·ª±ng m√¥ h√¨nh d·ª± ƒëo√°n ho·∫°t t√≠nh sinh h·ªçc c·ªßa c√°c h·ª£p ch·∫•t d·ª±a tr√™n c·∫•u tr√∫c h√≥a h·ªçc c·ªßa ch√∫ng.</li>
<li><strong>Ph√¢n t√≠ch c·ª•m (Clustering):</strong> Nh√≥m c√°c h·ª£p ch·∫•t c√≥ ƒë·∫∑c ƒëi·ªÉm t∆∞∆°ng ƒë·ªìng (v√≠ d·ª•: c·∫•u tr√∫c, ho·∫°t t√≠nh) ƒë·ªÉ x√°c ƒë·ªãnh c√°c "scaffold" ti·ªÅm nƒÉng.</li>
<li><strong>Ph√¢n t√≠ch ƒëa d·∫°ng h√≥a:</strong> Ch·ªçn m·ªôt t·∫≠p h·ª£p con c√°c h·ª£p ch·∫•t ƒë·∫°i di·ªán cho s·ª± ƒëa d·∫°ng c·∫•u tr√∫c c·ªßa to√†n b·ªô t·∫≠p d·ªØ li·ªáu.</li>
<li><strong>Ph√¢n t√≠ch ƒëi·ªÉm n√≥ng (Hotspot analysis):</strong> X√°c ƒë·ªãnh c√°c v√πng quan tr·ªçng tr√™n protein ƒë√≠ch m√† c√°c ph√¢n t·ª≠ thu·ªëc n√™n t∆∞∆°ng t√°c ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c ho·∫°t t√≠nh cao.</li>
<li><strong>Ph√¢n t√≠ch li√™n k·∫øt c·∫•u tr√∫c-ho·∫°t t√≠nh 3D (3D-QSAR):</strong> M·ªü r·ªông SAR/QSAR b·∫±ng c√°ch xem x√©t c·∫•u tr√∫c 3D c·ªßa c√°c ph√¢n t·ª≠ v√† protein.</li>
<li><strong>H·ªçc m√°y (Machine Learning):</strong> S·ª≠ d·ª•ng c√°c thu·∫≠t to√°n h·ªçc m√°y ƒë·ªÉ d·ª± ƒëo√°n ho·∫°t t√≠nh, ƒë·ªô tan, ƒë·ªôc t√≠nh, ho·∫∑c c√°c thu·ªôc t√≠nh quan tr·ªçng kh√°c c·ªßa thu·ªëc.</li>
</ul>
<p><strong>2. H∆∞·ªõng d·∫´n song ng·ªØ (Bilingual Instructions):</strong></p>
<ul>
<li><strong>English:</strong> We will use SQL to extract data from the ChEMBL database, and Python (with RDKit) to process and analyze the data.  We will focus on addressing the errors you encountered and providing clear, concise code examples.</li>
<li><strong>Ti·∫øng Vi·ªát:</strong> Ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng SQL ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL v√† Python (v·ªõi RDKit) ƒë·ªÉ x·ª≠ l√Ω v√† ph√¢n t√≠ch d·ªØ li·ªáu. Ch√∫ng ta s·∫Ω t·∫≠p trung v√†o vi·ªác gi·∫£i quy·∫øt c√°c l·ªói b·∫°n g·∫∑p ph·∫£i v√† cung c·∫•p c√°c v√≠ d·ª• code r√µ r√†ng, d·ªÖ hi·ªÉu.</li>
</ul>
<p><strong>3. Code SQL v√† Python (SQL and Python Code):</strong></p>
<p><strong>3.1. S·ª≠a l·ªói SQL (Fixing SQL Error):</strong></p>
<p>L·ªói <code>ERROR: operator does not exist: numeric ~ unknown</code> x·∫£y ra do b·∫°n ƒëang c·ªë g·∫Øng s·ª≠ d·ª•ng to√°n t·ª≠ <code>~</code> (regular expression match) tr√™n m·ªôt c·ªôt ki·ªÉu s·ªë (numeric). ƒê·ªÉ kh·∫Øc ph·ª•c, b·∫°n c√≥ th·ªÉ √©p ki·ªÉu c·ªôt <code>standard_value</code> sang ki·ªÉu text tr∆∞·ªõc khi so s√°nh:</p>
<p>```sql
-- English
SELECT *
FROM activities act
WHERE act.standard_type = 'IC50'
  AND act.standard_relation = '='
  AND act.standard_value IS NOT NULL
  AND act.standard_value::TEXT ~ '^[0-9.]+$' -- Cast to TEXT
LIMIT 100;</p>
<p>-- Vietnamese
-- Ch·ªçn t·∫•t c·∫£ c√°c c·ªôt t·ª´ b·∫£ng activities
-- v·ªõi ƒëi·ªÅu ki·ªán standard_type l√† 'IC50', standard_relation l√† '=',
-- standard_value kh√¥ng null v√† l√† m·ªôt s·ªë (ch·ª©a ch·ªØ s·ªë v√† d·∫•u ch·∫•m)
-- Gi·ªõi h·∫°n k·∫øt qu·∫£ tr·∫£ v·ªÅ 100 d√≤ng
SELECT *
FROM activities act
WHERE act.standard_type = 'IC50'
  AND act.standard_relation = '='
  AND act.standard_value IS NOT NULL
  AND act.standard_value::TEXT ~ '^[0-9.]+$' -- √âp ki·ªÉu sang TEXT
LIMIT 100;
```</p>
<p><strong>L∆∞u √Ω:</strong> B·∫°n n√™n ki·ªÉm tra k·ªπ ki·ªÉu d·ªØ li·ªáu c·ªßa c·ªôt <code>standard_value</code> ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng n√≥ th·ª±c s·ª± l√† ki·ªÉu s·ªë. N·∫øu kh√¥ng, c√≥ th·ªÉ c·∫ßn ph·∫£i x·ª≠ l√Ω d·ªØ li·ªáu tr∆∞·ªõc khi s·ª≠ d·ª•ng n√≥.</p>
<p><strong>3.2. Code Python (Python Code):</strong></p>
<p>```python</p>
<h1>English</h1>
<p>import os
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
import numpy as np</p>
<h1>Base path</h1>
<p>base_path = "."  # Adjust if needed</p>
<h1>Load data (assuming you saved the SQL output to a CSV file)</h1>
<p>data_file = os.path.join(base_path, "data", "chembl_activities.csv")  # Replace with your actual file name
try:
    df = pd.read_csv(data_file)
except FileNotFoundError:
    print(f"Error: File not found at {data_file}.  Make sure you have run the SQL query and saved the results to this file.")
    exit()</p>
<h1>Function to calculate molecular descriptors using RDKit</h1>
<p>def calculate_descriptors(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return None
    descriptors = {}
    for name, func in Descriptors.descList:
        try:
            descriptors[name] = func(mol)
        except:
            descriptors[name] = np.nan # Handle errors during descriptor calculation
    return pd.Series(descriptors)</p>
<h1>Apply descriptor calculation</h1>
<h1>Assuming you have a column named 'canonical_smiles' in your dataframe</h1>
<p>if 'canonical_smiles' not in df.columns:
    print("Error: 'canonical_smiles' column not found in the dataframe.  Please check your data.")
    exit()</p>
<p>df_descriptors = df['canonical_smiles'].apply(calculate_descriptors)</p>
<h1>Merge descriptors with the original dataframe</h1>
<p>df = pd.concat([df, df_descriptors], axis=1)</p>
<h1>Data cleaning: Handle missing values (NaN)</h1>
<p>df = df.dropna()  # Remove rows with any NaN values. Consider more sophisticated imputation methods if needed.</p>
<h1>Prepare data for modeling</h1>
<p>X = df.iloc[:, 17:]  # Select descriptor columns (adjust column indices as needed)
y = df['standard_value'] # Target variable</p>
<h1>Split data into training and testing sets</h1>
<p>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</p>
<h1>Train a linear regression model</h1>
<p>model = LinearRegression()
model.fit(X_train, y_train)</p>
<h1>Make predictions</h1>
<p>y_pred = model.predict(X_test)</p>
<h1>Evaluate the model</h1>
<p>mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)</p>
<p>print(f"Mean Squared Error: {mse}")
print(f"R-squared: {r2}")</p>
<h1>Vietnamese</h1>
<h1>Import c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt</h1>
<h1>ƒê∆∞·ªùng d·∫´n c∆° s·ªü</h1>
<h1>T·∫£i d·ªØ li·ªáu (gi·∫£ s·ª≠ b·∫°n ƒë√£ l∆∞u k·∫øt qu·∫£ SQL v√†o m·ªôt file CSV)</h1>
<h1>H√†m t√≠nh to√°n c√°c descriptor ph√¢n t·ª≠ b·∫±ng RDKit</h1>
<h1>√Åp d·ª•ng t√≠nh to√°n descriptor</h1>
<h1>G·ªôp c√°c descriptor v√†o dataframe g·ªëc</h1>
<h1>L√†m s·∫°ch d·ªØ li·ªáu: X·ª≠ l√Ω c√°c gi√° tr·ªã thi·∫øu (NaN)</h1>
<h1>Chu·∫©n b·ªã d·ªØ li·ªáu cho m√¥ h√¨nh h√≥a</h1>
<h1>Chia d·ªØ li·ªáu th√†nh t·∫≠p hu·∫•n luy·ªán v√† t·∫≠p ki·ªÉm tra</h1>
<h1>Hu·∫•n luy·ªán m√¥ h√¨nh h·ªìi quy tuy·∫øn t√≠nh</h1>
<h1>D·ª± ƒëo√°n</h1>
<h1>ƒê√°nh gi√° m√¥ h√¨nh</h1>
<h1>In ra c√°c k·∫øt qu·∫£ ƒë√°nh gi√°</h1>
<p>```</p>
<p><strong>Gi·∫£i th√≠ch code Python:</strong></p>
<ol>
<li><strong>Import th∆∞ vi·ªán:</strong> Nh·∫≠p c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt (RDKit, pandas, scikit-learn).</li>
<li><strong>ƒê∆∞·ªùng d·∫´n c∆° s·ªü:</strong> X√°c ƒë·ªãnh ƒë∆∞·ªùng d·∫´n c∆° s·ªü c·ªßa d·ª± √°n.</li>
<li><strong>T·∫£i d·ªØ li·ªáu:</strong> ƒê·ªçc d·ªØ li·ªáu t·ª´ file CSV ƒë√£ xu·∫•t ra t·ª´ SQL. <strong>Quan tr·ªçng:</strong> Thay ƒë·ªïi <code>chembl_activities.csv</code> th√†nh t√™n file th·ª±c t·∫ø c·ªßa b·∫°n.</li>
<li><strong>H√†m t√≠nh to√°n descriptor:</strong> ƒê·ªãnh nghƒ©a m·ªôt h√†m ƒë·ªÉ t√≠nh to√°n c√°c descriptor ph√¢n t·ª≠ t·ª´ SMILES b·∫±ng RDKit.  H√†m n√†y x·ª≠ l√Ω c·∫£ tr∆∞·ªùng h·ª£p SMILES kh√¥ng h·ª£p l·ªá b·∫±ng c√°ch tr·∫£ v·ªÅ <code>None</code>.</li>
<li><strong>√Åp d·ª•ng t√≠nh to√°n descriptor:</strong> √Åp d·ª•ng h√†m t√≠nh to√°n descriptor cho c·ªôt SMILES trong dataframe. <strong>Quan tr·ªçng:</strong> Gi·∫£ s·ª≠ r·∫±ng dataframe c·ªßa b·∫°n c√≥ m·ªôt c·ªôt t√™n l√† <code>canonical_smiles</code>. N·∫øu kh√¥ng, h√£y thay ƒë·ªïi t√™n c·ªôt cho ph√π h·ª£p.</li>
<li><strong>G·ªôp descriptor:</strong> G·ªôp c√°c descriptor m·ªõi t√≠nh ƒë∆∞·ª£c v√†o dataframe g·ªëc.</li>
<li><strong>L√†m s·∫°ch d·ªØ li·ªáu:</strong> Lo·∫°i b·ªè c√°c d√≤ng c√≥ gi√° tr·ªã NaN (missing values). ƒêi·ªÅu n√†y r·∫•t quan tr·ªçng v√¨ nhi·ªÅu thu·∫≠t to√°n h·ªçc m√°y kh√¥ng x·ª≠ l√Ω ƒë∆∞·ª£c NaN.  B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p ph·ª©c t·∫°p h∆°n ƒë·ªÉ x·ª≠ l√Ω missing values n·∫øu c·∫ßn.</li>
<li><strong>Chu·∫©n b·ªã d·ªØ li·ªáu:</strong> Ch·ªçn c√°c c·ªôt descriptor l√†m bi·∫øn ƒë·ªôc l·∫≠p (X) v√† c·ªôt <code>standard_value</code> l√†m bi·∫øn ph·ª• thu·ªôc (y). <strong>Quan tr·ªçng:</strong> B·∫°n c·∫ßn ƒëi·ªÅu ch·ªânh c√°c ch·ªâ s·ªë c·ªôt (column indices) cho ph√π h·ª£p v·ªõi dataframe c·ªßa b·∫°n.</li>
<li><strong>Chia d·ªØ li·ªáu:</strong> Chia d·ªØ li·ªáu th√†nh t·∫≠p hu·∫•n luy·ªán v√† t·∫≠p ki·ªÉm tra.</li>
<li><strong>Hu·∫•n luy·ªán m√¥ h√¨nh:</strong> Kh·ªüi t·∫°o v√† hu·∫•n luy·ªán m·ªôt m√¥ h√¨nh h·ªìi quy tuy·∫øn t√≠nh.</li>
<li><strong>D·ª± ƒëo√°n:</strong> D·ª± ƒëo√°n gi√° tr·ªã tr√™n t·∫≠p ki·ªÉm tra.</li>
<li><strong>ƒê√°nh gi√° m√¥ h√¨nh:</strong> T√≠nh to√°n c√°c ƒë·ªô ƒëo ƒë√°nh gi√° m√¥ h√¨nh (v√≠ d·ª•: MSE, R-squared).</li>
</ol>
<p><strong>3.3. S·ª≠a l·ªói scikit-learn (Fixing scikit-learn error):</strong></p>
<p>N·∫øu b·∫°n ƒëang s·ª≠ d·ª•ng phi√™n b·∫£n scikit-learn c≈©, b·∫°n c√≥ th·ªÉ g·∫∑p l·ªói li√™n quan ƒë·∫øn tham s·ªë <code>squared=False</code> trong h√†m <code>mean_squared_error</code>.  Trong c√°c phi√™n b·∫£n c≈©, tham s·ªë n√†y kh√¥ng t·ªìn t·∫°i.  ƒê·ªÉ kh·∫Øc ph·ª•c, b·∫°n c√≥ th·ªÉ t√≠nh cƒÉn b·∫≠c hai c·ªßa MSE theo c√°ch th·ªß c√¥ng:</p>
<p>```python</p>
<h1>English</h1>
<p>mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)  # Calculate RMSE manually
print(f"Root Mean Squared Error: {rmse}")</p>
<h1>Vietnamese</h1>
<h1>T√≠nh to√°n sai s·ªë b√¨nh ph∆∞∆°ng trung b√¨nh</h1>
<h1>T√≠nh cƒÉn b·∫≠c hai c·ªßa MSE ƒë·ªÉ c√≥ RMSE</h1>
<h1>In ra RMSE</h1>
<p>mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)  # T√≠nh RMSE th·ªß c√¥ng
print(f"CƒÉn b·∫≠c hai c·ªßa sai s·ªë b√¨nh ph∆∞∆°ng trung b√¨nh: {rmse}")
```</p>
<p>Ho·∫∑c, b·∫°n n√™n n√¢ng c·∫•p scikit-learn l√™n phi√™n b·∫£n m·ªõi nh·∫•t ƒë·ªÉ s·ª≠ d·ª•ng tham s·ªë <code>squared=False</code> m·ªôt c√°ch tr·ª±c ti·∫øp:</p>
<p><code>pip install -U scikit-learn</code></p>
<p><strong>4. V√≠ d·ª• code SQL v√† Python m·∫´u (Example SQL and Python Code):</strong></p>
<p>D∆∞·ªõi ƒë√¢y l√† 5 v√≠ d·ª• code SQL v√† Python m·∫´u, minh h·ªça c√°c thao t√°c kh√°c nhau m√† b·∫°n c√≥ th·ªÉ th·ª±c hi·ªán v·ªõi d·ªØ li·ªáu ChEMBL v√† RDKit.</p>
<p><strong>V√≠ d·ª• 1: L·ªçc c√°c h·ª£p ch·∫•t c√≥ ho·∫°t t√≠nh IC50 d∆∞·ªõi 100 nM (SQL &amp; Python)</strong></p>
<ul>
<li><strong>SQL:</strong></li>
</ul>
<p>```sql
-- English
SELECT molregno, canonical_smiles, standard_value
FROM activities act
JOIN molecule_dictionary md ON act.molregno = md.molregno
WHERE act.standard_type = 'IC50'
  AND act.standard_relation = '='
  AND act.standard_value &lt;= 100
  AND act.standard_units = 'nM'
LIMIT 100;</p>
<p>-- Vietnamese
-- L·ª±a ch·ªçn molregno, canonical_smiles v√† standard_value
-- t·ª´ b·∫£ng activities v√† molecule_dictionary
-- v·ªõi ƒëi·ªÅu ki·ªán standard_type l√† 'IC50', standard_relation l√† '=',
-- standard_value nh·ªè h∆°n ho·∫∑c b·∫±ng 100 v√† ƒë∆°n v·ªã l√† 'nM'
-- Gi·ªõi h·∫°n k·∫øt qu·∫£ tr·∫£ v·ªÅ 100 d√≤ng
SELECT molregno, canonical_smiles, standard_value
FROM activities act
JOIN molecule_dictionary md ON act.molregno = md.molregno
WHERE act.standard_type = 'IC50'
  AND act.standard_relation = '='
  AND act.standard_value &lt;= 100
  AND act.standard_units = 'nM'
LIMIT 100;
```</p>
<ul>
<li><strong>Python:</strong> (sau khi ƒë√£ load d·ªØ li·ªáu t·ª´ CSV)</li>
</ul>
<p>```python</p>
<h1>English</h1>
<p>import pandas as pd
from rdkit import Chem
from rdkit.Chem import Draw</p>
<h1>Assuming you have a DataFrame named 'df' with 'canonical_smiles' column</h1>
<h1>Filter for compounds with IC50 &lt;= 100 nM</h1>
<p>active_compounds = df[(df['standard_type'] == 'IC50') &amp; (df['standard_relation'] == '=') &amp; (df['standard_value'] &lt;= 100) &amp; (df['standard_units'] == 'nM')]</p>
<h1>Print the first 5 SMILES strings</h1>
<p>print(active_compounds['canonical_smiles'].head())</p>
<h1>Visualize the first 3 molecules</h1>
<p>smiles_list = active_compounds['canonical_smiles'].head(3).tolist()
mols = [Chem.MolFromSmiles(smiles) for smiles in smiles_list]
img = Draw.MolsToGridImage(mols, molsPerRow=3, subImgSize=(200, 200))
img  # Display the image (in Jupyter Notebook)</p>
<h1>Vietnamese</h1>
<h1>L·ªçc c√°c h·ª£p ch·∫•t c√≥ IC50 nh·ªè h∆°n ho·∫∑c b·∫±ng 100 nM</h1>
<h1>In ra 5 chu·ªói SMILES ƒë·∫ßu ti√™n</h1>
<h1>Tr·ª±c quan h√≥a 3 ph√¢n t·ª≠ ƒë·∫ßu ti√™n</h1>
<p>import pandas as pd
from rdkit import Chem
from rdkit.Chem import Draw</p>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt DataFrame t√™n l√† 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<h1>L·ªçc c√°c h·ª£p ch·∫•t c√≥ IC50 &lt;= 100 nM</h1>
<p>active_compounds = df[(df['standard_type'] == 'IC50') &amp; (df['standard_relation'] == '=') &amp; (df['standard_value'] &lt;= 100) &amp; (df['standard_units'] == 'nM')]</p>
<h1>In ra 5 chu·ªói SMILES ƒë·∫ßu ti√™n</h1>
<p>print(active_compounds['canonical_smiles'].head())</p>
<h1>Tr·ª±c quan h√≥a 3 ph√¢n t·ª≠ ƒë·∫ßu ti√™n</h1>
<p>smiles_list = active_compounds['canonical_smiles'].head(3).tolist()
mols = [Chem.MolFromSmiles(smiles) for smiles in smiles_list]
img = Draw.MolsToGridImage(mols, molsPerRow=3, subImgSize=(200, 200))
img  # Hi·ªÉn th·ªã h√¨nh ·∫£nh (trong Jupyter Notebook)
```</p>
<p><strong>V√≠ d·ª• 2: T√≠nh to√°n tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠ (Molecular Weight) cho c√°c h·ª£p ch·∫•t (Python)</strong></p>
<p>```python</p>
<h1>English</h1>
<p>from rdkit import Chem
from rdkit.Chem import Descriptors
import pandas as pd</p>
<h1>Assuming you have a DataFrame named 'df' with 'canonical_smiles' column</h1>
<p>def calculate_mw(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Descriptors.MolWt(mol)
    else:
        return None</p>
<p>df['molecular_weight'] = df['canonical_smiles'].apply(calculate_mw)
print(df[['canonical_smiles', 'molecular_weight']].head())</p>
<h1>Vietnamese</h1>
<h1>T√≠nh to√°n tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠</h1>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ DataFrame 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<p>from rdkit import Chem
from rdkit.Chem import Descriptors
import pandas as pd</p>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt DataFrame t√™n l√† 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<p>def calculate_mw(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Descriptors.MolWt(mol)
    else:
        return None</p>
<p>df['molecular_weight'] = df['canonical_smiles'].apply(calculate_mw)
print(df[['canonical_smiles', 'molecular_weight']].head())
```</p>
<p><strong>V√≠ d·ª• 3: T√≠nh to√°n LogP v√† v·∫Ω histogram (Python)</strong></p>
<p>```python</p>
<h1>English</h1>
<p>from rdkit import Chem
from rdkit.Chem import Crippen
import matplotlib.pyplot as plt
import pandas as pd</p>
<h1>Assuming you have a DataFrame named 'df' with 'canonical_smiles' column</h1>
<p>def calculate_logp(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Crippen.MolLogP(mol)
    else:
        return None</p>
<p>df['logp'] = df['canonical_smiles'].apply(calculate_logp)</p>
<h1>Plot a histogram of LogP values</h1>
<p>plt.hist(df['logp'].dropna(), bins=20)  # Drop NaN values before plotting
plt.xlabel('LogP')
plt.ylabel('Frequency')
plt.title('Distribution of LogP Values')
plt.show()</p>
<h1>Vietnamese</h1>
<h1>T√≠nh to√°n LogP v√† v·∫Ω bi·ªÉu ƒë·ªì</h1>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ DataFrame 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<p>from rdkit import Chem
from rdkit.Chem import Crippen
import matplotlib.pyplot as plt
import pandas as pd</p>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt DataFrame t√™n l√† 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<p>def calculate_logp(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Crippen.MolLogP(mol)
    else:
        return None</p>
<p>df['logp'] = df['canonical_smiles'].apply(calculate_logp)</p>
<h1>V·∫Ω bi·ªÉu ƒë·ªì histogram c·ªßa c√°c gi√° tr·ªã LogP</h1>
<p>plt.hist(df['logp'].dropna(), bins=20)  # Lo·∫°i b·ªè c√°c gi√° tr·ªã NaN tr∆∞·ªõc khi v·∫Ω
plt.xlabel('LogP')
plt.ylabel('T·∫ßn s·ªë')
plt.title('Ph√¢n ph·ªëi c·ªßa c√°c gi√° tr·ªã LogP')
plt.show()
```</p>
<p><strong>V√≠ d·ª• 4: T√¨m ki·∫øm c√°c h·ª£p ch·∫•t ch·ª©a m·ªôt motif nh·∫•t ƒë·ªãnh (SMARTS query) (Python)</strong></p>
<p>```python</p>
<h1>English</h1>
<p>from rdkit import Chem
import pandas as pd</p>
<h1>Assuming you have a DataFrame named 'df' with 'canonical_smiles' column</h1>
<h1>Define a SMARTS pattern (e.g., benzene ring)</h1>
<p>benzene_smarts = Chem.MolFromSmarts('c1ccccc1')</p>
<p>def has_benzene_ring(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return mol.HasSubstructMatch(benzene_smarts)
    else:
        return False</p>
<p>df['has_benzene'] = df['canonical_smiles'].apply(has_benzene_ring)</p>
<h1>Filter the DataFrame to show only compounds with a benzene ring</h1>
<p>benzene_compounds = df[df['has_benzene'] == True]
print(benzene_compounds[['canonical_smiles', 'has_benzene']].head())</p>
<h1>Vietnamese</h1>
<h1>T√¨m ki·∫øm c√°c h·ª£p ch·∫•t ch·ª©a v√≤ng benzen</h1>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ DataFrame 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<p>from rdkit import Chem
import pandas as pd</p>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt DataFrame t√™n l√† 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<h1>ƒê·ªãnh nghƒ©a m·ªôt m·∫´u SMARTS (v√≠ d·ª•: v√≤ng benzen)</h1>
<p>benzene_smarts = Chem.MolFromSmarts('c1ccccc1')</p>
<p>def has_benzene_ring(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return mol.HasSubstructMatch(benzene_smarts)
    else:
        return False</p>
<p>df['has_benzene'] = df['canonical_smiles'].apply(has_benzene_ring)</p>
<h1>L·ªçc DataFrame ƒë·ªÉ ch·ªâ hi·ªÉn th·ªã c√°c h·ª£p ch·∫•t c√≥ v√≤ng benzen</h1>
<p>benzene_compounds = df[df['has_benzene'] == True]
print(benzene_compounds[['canonical_smiles', 'has_benzene']].head())
```</p>
<p><strong>V√≠ d·ª• 5: T√≠nh TPSA (Topological Polar Surface Area) (Python)</strong></p>
<p>```python</p>
<h1>English</h1>
<p>from rdkit import Chem
from rdkit.Chem import Descriptors3D
import pandas as pd</p>
<h1>Assuming you have a DataFrame named 'df' with 'canonical_smiles' column</h1>
<p>def calculate_tpsa(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Descriptors3D.TPSA(mol)
    else:
        return None</p>
<p>df['tpsa'] = df['canonical_smiles'].apply(calculate_tpsa)
print(df[['canonical_smiles', 'tpsa']].head())</p>
<h1>Vietnamese</h1>
<h1>T√≠nh TPSA (Di·ªán t√≠ch b·ªÅ m·∫∑t c·ª±c topo)</h1>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ DataFrame 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<p>from rdkit import Chem
from rdkit.Chem import Descriptors3D
import pandas as pd</p>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt DataFrame t√™n l√† 'df' v·ªõi c·ªôt 'canonical_smiles'</h1>
<p>def calculate_tpsa(smiles):
    mol = Chem.MolFromSmiles(smiles)
    if mol:
        return Descriptors3D.TPSA(mol)
    else:
        return None</p>
<p>df['tpsa'] = df['canonical_smiles'].apply(calculate_tpsa)
print(df[['canonical_smiles', 'tpsa']].head())
```</p>
<p><strong>L∆∞u √Ω quan tr·ªçng:</strong></p>
<ul>
<li><strong>Thay ƒë·ªïi t√™n file v√† c·ªôt:</strong>  H√£y nh·ªõ thay ƒë·ªïi t√™n file CSV v√† t√™n c·ªôt trong code cho ph√π h·ª£p v·ªõi d·ªØ li·ªáu c·ªßa b·∫°n.</li>
<li><strong>X·ª≠ l√Ω l·ªói:</strong> Lu√¥n lu√¥n ki·ªÉm tra v√† x·ª≠ l√Ω c√°c l·ªói c√≥ th·ªÉ x·∫£y ra trong qu√° tr√¨nh t√≠nh to√°n descriptor v√† ph√¢n t√≠ch d·ªØ li·ªáu.</li>
<li><strong>ƒêi·ªÅu ch·ªânh tham s·ªë:</strong> ƒêi·ªÅu ch·ªânh c√°c tham s·ªë c·ªßa c√°c thu·∫≠t to√°n h·ªçc m√°y v√† c√°c ph∆∞∆°ng ph√°p ph√¢n t√≠ch kh√°c ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c k·∫øt qu·∫£ t·ªët nh·∫•t.</li>
<li><strong>Ph√¢n t√≠ch k·∫øt qu·∫£:</strong>  Quan tr·ªçng nh·∫•t l√† ph√¢n t√≠ch v√† di·ªÖn gi·∫£i k·∫øt qu·∫£ c·ªßa b·∫°n m·ªôt c√°ch c·∫©n th·∫≠n ƒë·ªÉ r√∫t ra nh·ªØng k·∫øt lu·∫≠n c√≥ √Ω nghƒ©a cho d·ª± √°n nghi√™n c·ª©u v√† ph√°t tri·ªÉn thu·ªëc c·ªßa b·∫°n.</li>
<li><strong>Gi·ªõi h·∫°n d·ªØ li·ªáu:</strong> C√°c truy v·∫•n SQL ƒë·ªÅu c√≥ <code>LIMIT 100</code> ƒë·ªÉ gi·ªõi h·∫°n s·ªë l∆∞·ª£ng d√≤ng tr·∫£ v·ªÅ. B·∫°n c√≥ th·ªÉ b·ªè <code>LIMIT</code> ƒë·ªÉ l·∫•y to√†n b·ªô d·ªØ li·ªáu, nh∆∞ng h√£y c·∫©n th·∫≠n v·ªõi hi·ªáu su·∫•t.</li>
</ul>
<p>T√¥i hy v·ªçng nh·ªØng h∆∞·ªõng d·∫´n v√† v√≠ d·ª• n√†y s·∫Ω gi√∫p b·∫°n b·∫Øt ƒë·∫ßu d·ª± √°n ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL 35 m·ªôt c√°ch hi·ªáu qu·∫£. N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi n√†o, ƒë·ª´ng ng·∫ßn ng·∫°i h·ªèi! Ch√∫c b·∫°n th√†nh c√¥ng!</p>
        </body>
        </html>
        

        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Topic_CheMBL_35_75</title>
            <style>
                body {
                    font-family: "Georgia", serif;
                    max-width: 800px;
                    margin: 40px auto;
                    padding: 20px;
                    line-height: 1.6;
                    background-color: #ffffff;
                    color: #333;
                }
                h1, h2, h3 {
                    color: #1a1a1a;
                }
                code {
                    background-color: #f5f5f5;
                    padding: 2px 4px;
                    border-radius: 4px;
                }
                pre {
                    background-color: #f5f5f5;
                    padding: 10px;
                    overflow-x: auto;
                    border-radius: 6px;
                }
            </style>
        </head>
        <body>
        <h1>PharmApp Suite</h1>
<h2>üß† AI for Drug Discovery and Development üß™</h2>
<p>| Copyright 2025 | Nghi√™n C·ª©u Thu·ªëc | www.nghiencuuthuoc.comlus | Zalo: +84888999311 |</p>
<h1>üß© Topic: Bi·ªÉu ƒë·ªì so s√°nh c√°c l·ªõp h·ª£p ch·∫•t</h1>
<hr />
<p>Tuy·ªát v·ªùi! T√¥i r·∫•t vui ƒë∆∞·ª£c h·ªó tr·ª£ b·∫°n trong d·ª± √°n ph√¢n t√≠ch d·ªØ li·ªáu ChEMBL 35 k·∫øt h·ª£p RDKit n√†y. V·ªõi vai tr√≤ l√† m·ªôt chuy√™n gia nghi√™n c·ª©u v√† ph√°t tri·ªÉn d∆∞·ª£c h·ªçc, t√¥i hi·ªÉu t·∫ßm quan tr·ªçng c·ªßa vi·ªác khai th√°c d·ªØ li·ªáu ChEMBL ƒë·ªÉ t√¨m ki·∫øm v√† ph√°t tri·ªÉn c√°c h·ª£p ch·∫•t ti·ªÅm nƒÉng. D∆∞·ªõi ƒë√¢y l√† ph√¢n t√≠ch chi ti·∫øt, h∆∞·ªõng d·∫´n song ng·ªØ v√† c√°c v√≠ d·ª• code m·∫´u, t·∫≠p trung v√†o m√£ ch·ªß ƒë·ªÅ "Topic_CheMBL_35_75".</p>
<p><strong>T√™n ch·ªß ƒë·ªÅ:</strong> Ph√¢n t√≠ch m·ªëi t∆∞∆°ng quan gi·ªØa c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a (physicochemical properties) v√† ho·∫°t t√≠nh sinh h·ªçc (biological activity) c·ªßa c√°c h·ª£p ch·∫•t trong ChEMBL 35, s·ª≠ d·ª•ng RDKit ƒë·ªÉ t√≠nh to√°n c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a.</p>
<p><strong>1. Ph√¢n t√≠ch m√¥ h√¨nh (Analysis of the Model):</strong></p>
<p>M·ª•c ti√™u c·ªßa ch·ªß ƒë·ªÅ n√†y l√† kh√°m ph√° m·ªëi li√™n h·ªá gi·ªØa c·∫•u tr√∫c h√≥a h·ªçc (ƒë∆∞·ª£c bi·ªÉu di·ªÖn th√¥ng qua c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a) v√† ho·∫°t t√≠nh sinh h·ªçc c·ªßa c√°c h·ª£p ch·∫•t. M√¥ h√¨nh ph√¢n t√≠ch s·∫Ω bao g·ªìm c√°c b∆∞·ªõc sau:</p>
<ul>
<li><strong>Tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ ChEMBL 35:</strong> S·ª≠ d·ª•ng SQL ƒë·ªÉ truy v·∫•n v√† l·∫•y d·ªØ li·ªáu v·ªÅ c√°c h·ª£p ch·∫•t (molecules) v√† ho·∫°t t√≠nh sinh h·ªçc c·ªßa ch√∫ng (activities).</li>
<li><strong>T√≠nh to√°n ƒë·∫∑c t√≠nh l√Ω h√≥a b·∫±ng RDKit:</strong> S·ª≠ d·ª•ng th∆∞ vi·ªán RDKit ƒë·ªÉ t√≠nh to√°n c√°c ƒë·∫∑c t√≠nh nh∆∞ tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠ (molecular weight), LogP, s·ªë l∆∞·ª£ng li√™n k·∫øt hydro cho (hydrogen bond donors), s·ªë l∆∞·ª£ng li√™n k·∫øt hydro nh·∫≠n (hydrogen bond acceptors), di·ªán t√≠ch b·ªÅ m·∫∑t ph√¢n c·ª±c (polar surface area),...</li>
<li><strong>Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu:</strong> L√†m s·∫°ch v√† chu·∫©n h√≥a d·ªØ li·ªáu, x·ª≠ l√Ω c√°c gi√° tr·ªã thi·∫øu (missing values) v√† ngo·∫°i l·ªá (outliers).</li>
<li><strong>Ph√¢n t√≠ch t∆∞∆°ng quan:</strong> S·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p th·ªëng k√™ (nh∆∞ h·ªá s·ªë t∆∞∆°ng quan Pearson, Spearman) v√†/ho·∫∑c c√°c m√¥ h√¨nh h·ªçc m√°y (machine learning models) ƒë·ªÉ ƒë√°nh gi√° m·ªëi t∆∞∆°ng quan gi·ªØa c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a v√† ho·∫°t t√≠nh sinh h·ªçc. C√°c m√¥ h√¨nh h·ªçc m√°y c√≥ th·ªÉ bao g·ªìm h·ªìi quy tuy·∫øn t√≠nh (linear regression), c√¢y quy·∫øt ƒë·ªãnh (decision trees), random forests, v√† m·∫°ng n∆°-ron (neural networks).</li>
<li><strong>Tr·ª±c quan h√≥a d·ªØ li·ªáu:</strong> S·ª≠ d·ª•ng c√°c bi·ªÉu ƒë·ªì (scatter plots, histograms, box plots) ƒë·ªÉ tr·ª±c quan h√≥a c√°c m·ªëi t∆∞∆°ng quan v√† k·∫øt qu·∫£ ph√¢n t√≠ch.</li>
</ul>
<p><strong>2. H∆∞·ªõng d·∫´n song ng·ªØ (Bilingual Guidance):</strong></p>
<p><strong>2.1. SQL (English &amp; Vietnamese):</strong></p>
<ul>
<li><strong>English:</strong> SQL will be used to extract data from the ChEMBL 35 database, including molecule information and their corresponding bioactivities.</li>
<li><strong>Vietnamese:</strong> SQL s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu ChEMBL 35, bao g·ªìm th√¥ng tin v·ªÅ c√°c ph√¢n t·ª≠ v√† ho·∫°t t√≠nh sinh h·ªçc t∆∞∆°ng ·ª©ng c·ªßa ch√∫ng.</li>
</ul>
<p><strong>2.2. Python (English &amp; Vietnamese):</strong></p>
<ul>
<li><strong>English:</strong> Python, with libraries like RDKit, Pandas, NumPy, and Scikit-learn, will be used for data manipulation, physicochemical property calculation, statistical analysis, and machine learning model building.</li>
<li><strong>Vietnamese:</strong> Python, v·ªõi c√°c th∆∞ vi·ªán nh∆∞ RDKit, Pandas, NumPy v√† Scikit-learn, s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu, t√≠nh to√°n c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a, ph√¢n t√≠ch th·ªëng k√™ v√† x√¢y d·ª±ng m√¥ h√¨nh h·ªçc m√°y.</li>
</ul>
<p><strong>3. Code m·∫´u (Code Examples):</strong></p>
<p><strong>3.1. SQL (chi·∫øt xu·∫•t d·ªØ li·ªáu, gi·ªõi h·∫°n 100 d√≤ng):</strong></p>
<p>```sql
-- English
SELECT
    md.molregno,
    cs.canonical_smiles,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'IC50'  -- You can change this to other activity types
    AND act.standard_units = 'nM'
    AND act.standard_value IS NOT NULL
    AND act.standard_value &gt; 0  -- Filter out invalid activity values
    AND act.standard_value ~ '^[0-9.]+$' -- added this line to solve the error
LIMIT 100;</p>
<p>-- Vietnamese
-- L·∫•y th√¥ng tin v·ªÅ ph√¢n t·ª≠, c·∫•u tr√∫c SMILES, lo·∫°i ho·∫°t t√≠nh, gi√° tr·ªã v√† ƒë∆°n v·ªã
-- t·ª´ c√°c b·∫£ng molecule_dictionary, compound_structures v√† activities.
-- L·ªçc theo lo·∫°i ho·∫°t t√≠nh l√† IC50, ƒë∆°n v·ªã l√† nM, v√† gi·ªõi h·∫°n k·∫øt qu·∫£ 100 d√≤ng.
SELECT
    md.molregno,  -- M√£ s·ªë ph√¢n t·ª≠
    cs.canonical_smiles,  -- C·∫•u tr√∫c SMILES
    act.standard_type,  -- Lo·∫°i ho·∫°t t√≠nh (v√≠ d·ª•: IC50)
    act.standard_value,  -- Gi√° tr·ªã ho·∫°t t√≠nh
    act.standard_units  -- ƒê∆°n v·ªã ho·∫°t t√≠nh
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'IC50'  -- L·ªçc theo lo·∫°i ho·∫°t t√≠nh IC50
    AND act.standard_units = 'nM'  -- L·ªçc theo ƒë∆°n v·ªã nM
    AND act.standard_value IS NOT NULL
    AND act.standard_value &gt; 0  -- Lo·∫°i b·ªè gi√° tr·ªã ho·∫°t t√≠nh kh√¥ng h·ª£p l·ªá
    AND act.standard_value ~ '^[0-9.]+$' -- Added this line to solve the error
LIMIT 100;  -- Gi·ªõi h·∫°n k·∫øt qu·∫£ 100 d√≤ng
```</p>
<p><strong>L∆∞u √Ω s·ª≠a l·ªói SQL:</strong></p>
<p>L·ªói <code>ERROR:  operator does not exist: numeric ~ unknown, LINE 12:   AND act.standard_value ~ '^[0-9\.]+$'</code> x·∫£y ra v√¨ b·∫°n ƒëang c·ªë g·∫Øng so s√°nh m·ªôt c·ªôt ki·ªÉu s·ªë (numeric) v·ªõi m·ªôt bi·ªÉu th·ª©c ch√≠nh quy (regular expression).  ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, b·∫°n c·∫ßn ƒë·∫£m b·∫£o r·∫±ng c·ªôt <code>act.standard_value</code> ch·ªâ ch·ª©a c√°c gi√° tr·ªã s·ªë (v√† d·∫•u ch·∫•m th·∫≠p ph√¢n). B·∫°n c√≥ th·ªÉ th√™m ƒëi·ªÅu ki·ªán <code>AND act.standard_value ~ '^[0-9\.]+$'</code> ƒë·ªÉ l·ªçc ra c√°c gi√° tr·ªã kh√¥ng h·ª£p l·ªá.  Ho·∫∑c b·∫°n c√≥ th·ªÉ √©p ki·ªÉu d·ªØ li·ªáu (cast) c·ªôt <code>act.standard_value</code> sang ki·ªÉu text tr∆∞·ªõc khi so s√°nh.</p>
<p><strong>3.2. Python (t√≠nh to√°n LogP b·∫±ng RDKit):</strong></p>
<p>```python</p>
<h1>English</h1>
<p>import os
import pandas as pd
from rdkit import Chem
from rdkit.Chem import AllChem
from rdkit.Chem import Descriptors</p>
<p>base_path = "." # Assuming the notebook is in the root of your project
data_path = os.path.join(base_path, "data")</p>
<h1>Assuming you have a CSV file named "chembl_data.csv" in the 'data' folder</h1>
<p>data_file = os.path.join(data_path, "chembl_data.csv")</p>
<h1>Create the 'data' directory if it doesn't exist</h1>
<p>if not os.path.exists(data_path):
    os.makedirs(data_path)</p>
<h1>Check if the data file exists</h1>
<p>if not os.path.exists(data_file):
    print(f"Error: The data file '{data_file}' does not exist. Please make sure you have the file in the correct location.")
else:
    df = pd.read_csv(data_file)</p>
<pre><code># Function to calculate LogP using RDKit
def calculate_logp(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol is not None:
            logp = Descriptors.MolLogP(mol)
            return logp
        else:
            return None
    except:
        return None

# Apply the function to the 'canonical_smiles' column
df['logp'] = df['canonical_smiles'].apply(calculate_logp)

# Print the first 10 rows with LogP values
print(df[['canonical_smiles', 'logp']].head(10))
</code></pre>
<h1>Vietnamese</h1>
<p>import os
import pandas as pd
from rdkit import Chem
from rdkit.Chem import AllChem
from rdkit.Chem import Descriptors</p>
<p>base_path = "." # Gi·∫£ s·ª≠ notebook n·∫±m ·ªü th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n
data_path = os.path.join(base_path, "data")</p>
<h1>Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt file CSV t√™n l√† "chembl_data.csv" trong th∆∞ m·ª•c 'data'</h1>
<p>data_file = os.path.join(data_path, "chembl_data.csv")</p>
<h1>T·∫°o th∆∞ m·ª•c 'data' n·∫øu n√≥ ch∆∞a t·ªìn t·∫°i</h1>
<p>if not os.path.exists(data_path):
    os.makedirs(data_path)</p>
<h1>Ki·ªÉm tra xem file d·ªØ li·ªáu c√≥ t·ªìn t·∫°i kh√¥ng</h1>
<p>if not os.path.exists(data_file):
    print(f"L·ªói: File d·ªØ li·ªáu '{data_file}' kh√¥ng t·ªìn t·∫°i. Vui l√≤ng ƒë·∫£m b·∫£o b·∫°n ƒë√£ ƒë·∫∑t file ƒë√∫ng v·ªã tr√≠.")
else:
    df = pd.read_csv(data_file)</p>
<pre><code># H√†m t√≠nh to√°n LogP s·ª≠ d·ª•ng RDKit
def calculate_logp(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol is not None:
            logp = Descriptors.MolLogP(mol)
            return logp
        else:
            return None
    except:
        return None

# √Åp d·ª•ng h√†m cho c·ªôt 'canonical_smiles'
df['logp'] = df['canonical_smiles'].apply(calculate_logp)

# In ra 10 d√≤ng ƒë·∫ßu ti√™n v·ªõi gi√° tr·ªã LogP
print(df[['canonical_smiles', 'logp']].head(10))
</code></pre>
<p>```</p>
<p><strong>3.3. Python (ph√¢n t√≠ch t∆∞∆°ng quan gi·ªØa LogP v√† pIC50):</strong></p>
<p>```python</p>
<h1>English</h1>
<p>import os
import pandas as pd
import numpy as np
from rdkit import Chem
from rdkit.Chem import Descriptors
from scipy.stats import pearsonr
from sklearn.metrics import mean_squared_error</p>
<p>base_path = "." # Assuming the notebook is in the root of your project
data_path = os.path.join(base_path, "data")
data_file = os.path.join(data_path, "chembl_data.csv")</p>
<p>if not os.path.exists(data_file):
    print(f"Error: The data file '{data_file}' does not exist. Please make sure you have the file in the correct location.")
else:
    df = pd.read_csv(data_file)</p>
<pre><code># Function to calculate LogP
def calculate_logp(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol is not None:
            logp = Descriptors.MolLogP(mol)
            return logp
        else:
            return None
    except:
        return None

df['logp'] = df['canonical_smiles'].apply(calculate_logp)

# Convert IC50 to pIC50
df['pIC50'] = -np.log10(df['standard_value'] / 1e9)  # Convert nM to M

# Drop rows with missing LogP or pIC50 values
df = df.dropna(subset=['logp', 'pIC50'])

# Calculate Pearson correlation coefficient
corr, p_value = pearsonr(df['logp'], df['pIC50'])
print(f"Pearson correlation between LogP and pIC50: {corr:.2f} (p-value: {p_value:.3f})")

# Simple Linear Regression (as an example, not necessarily the best model)
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split

X = df[['logp']]
y = df['pIC50']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = LinearRegression()
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

# Calculate Mean Squared Error
mse = mean_squared_error(y_test, y_pred)
print(f"Mean Squared Error: {mse:.2f}")
</code></pre>
<h1>Vietnamese</h1>
<p>import os
import pandas as pd
import numpy as np
from rdkit import Chem
from rdkit.Chem import Descriptors
from scipy.stats import pearsonr
from sklearn.metrics import mean_squared_error</p>
<p>base_path = "." # Gi·∫£ s·ª≠ notebook n·∫±m ·ªü th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n
data_path = os.path.join(base_path, "data")
data_file = os.path.join(data_path, "chembl_data.csv")</p>
<p>if not os.path.exists(data_file):
    print(f"L·ªói: File d·ªØ li·ªáu '{data_file}' kh√¥ng t·ªìn t·∫°i. Vui l√≤ng ƒë·∫£m b·∫£o b·∫°n ƒë√£ ƒë·∫∑t file ƒë√∫ng v·ªã tr√≠.")
else:
    df = pd.read_csv(data_file)</p>
<pre><code># H√†m t√≠nh to√°n LogP
def calculate_logp(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol is not None:
            logp = Descriptors.MolLogP(mol)
            return logp
        else:
            return None
    except:
        return None

df['logp'] = df['canonical_smiles'].apply(calculate_logp)

# Chuy·ªÉn ƒë·ªïi IC50 sang pIC50
df['pIC50'] = -np.log10(df['standard_value'] / 1e9)  # Chuy·ªÉn ƒë·ªïi nM sang M

# Lo·∫°i b·ªè c√°c h√†ng c√≥ gi√° tr·ªã LogP ho·∫∑c pIC50 b·ªã thi·∫øu
df = df.dropna(subset=['logp', 'pIC50'])

# T√≠nh to√°n h·ªá s·ªë t∆∞∆°ng quan Pearson
corr, p_value = pearsonr(df['logp'], df['pIC50'])
print(f"T∆∞∆°ng quan Pearson gi·ªØa LogP v√† pIC50: {corr:.2f} (p-value: {p_value:.3f})")

# H·ªìi quy tuy·∫øn t√≠nh ƒë∆°n gi·∫£n (v√≠ d·ª•, kh√¥ng nh·∫•t thi·∫øt l√† m√¥ h√¨nh t·ªët nh·∫•t)
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split

X = df[['logp']]
y = df['pIC50']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = LinearRegression()
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

# T√≠nh to√°n sai s·ªë b√¨nh ph∆∞∆°ng trung b√¨nh
mse = mean_squared_error(y_test, y_pred)
print(f"Sai s·ªë b√¨nh ph∆∞∆°ng trung b√¨nh: {mse:.2f}")
</code></pre>
<p>```</p>
<p><strong>L∆∞u √Ω s·ª≠a l·ªói Python:</strong></p>
<ul>
<li><strong><code>mean_squared_error(y_test, y_pred, squared=False)</code>:</strong> N·∫øu b·∫°n ƒëang s·ª≠ d·ª•ng phi√™n b·∫£n scikit-learn c≈©, tham s·ªë <code>squared=False</code> c√≥ th·ªÉ kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£.  Trong tr∆∞·ªùng h·ª£p ƒë√≥, h√£y b·ªè tham s·ªë n√†y ƒëi v√† t√≠nh cƒÉn b·∫≠c hai c·ªßa k·∫øt qu·∫£ n·∫øu b·∫°n mu·ªën t√≠nh RMSE (Root Mean Squared Error).</li>
</ul>
<p><strong>3.4.  SQL (Extracting Specific Molecules with Molecular Weight):</strong></p>
<p>```sql
-- English
SELECT
    md.molregno,
    cs.canonical_smiles,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'Ki'  -- Example: Select based on inhibition constant
    AND act.standard_units = 'nM'
    AND md.mw_freebase BETWEEN 200 AND 400  -- Filter by molecular weight range
LIMIT 100;</p>
<p>-- Vietnamese
-- L·∫•y th√¥ng tin ph√¢n t·ª≠ v·ªõi tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠ n·∫±m trong kho·∫£ng nh·∫•t ƒë·ªãnh.
SELECT
    md.molregno,
    cs.canonical_smiles,
    act.standard_type,
    act.standard_value,
    act.standard_units
FROM
    molecule_dictionary md
JOIN
    compound_structures cs ON md.molregno = cs.molregno
JOIN
    activities act ON md.molregno = act.molregno
WHERE
    act.standard_type = 'Ki'  -- Ch·ªçn d·ª±a tr√™n h·∫±ng s·ªë ·ª©c ch·∫ø
    AND act.standard_units = 'nM'
    AND md.mw_freebase BETWEEN 200 AND 400  -- L·ªçc theo kho·∫£ng tr·ªçng l∆∞·ª£ng ph√¢n t·ª≠
LIMIT 100;
```</p>
<p><strong>3.5. Python (Calculating TPSA):</strong></p>
<p>```python</p>
<h1>English</h1>
<p>import os
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors</p>
<p>base_path = "."
data_path = os.path.join(base_path, "data")
data_file = os.path.join(data_path, "chembl_data.csv")</p>
<p>if not os.path.exists(data_file):
    print(f"Error: The data file '{data_file}' does not exist.")
else:
    df = pd.read_csv(data_file)</p>
<pre><code>def calculate_tpsa(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol is not None:
            tpsa = Descriptors.TPSA(mol)
            return tpsa
        else:
            return None
    except:
        return None

df['tpsa'] = df['canonical_smiles'].apply(calculate_tpsa)
print(df[['canonical_smiles', 'tpsa']].head())
</code></pre>
<h1>Vietnamese</h1>
<h1>T√≠nh to√°n di·ªán t√≠ch b·ªÅ m·∫∑t ph√¢n c·ª±c (TPSA).</h1>
<p>import os
import pandas as pd
from rdkit import Chem
from rdkit.Chem import Descriptors</p>
<p>base_path = "."
data_path = os.path.join(base_path, "data")
data_file = os.path.join(data_path, "chembl_data.csv")</p>
<p>if not os.path.exists(data_file):
    print(f"L·ªói: File d·ªØ li·ªáu '{data_file}' kh√¥ng t·ªìn t·∫°i.")
else:
    df = pd.read_csv(data_file)</p>
<pre><code>def calculate_tpsa(smiles):
    try:
        mol = Chem.MolFromSmiles(smiles)
        if mol is not None:
            tpsa = Descriptors.TPSA(mol)
            return tpsa
        else:
            return None
    except:
        return None

df['tpsa'] = df['canonical_smiles'].apply(calculate_tpsa)
print(df[['canonical_smiles', 'tpsa']].head())
</code></pre>
<p>```</p>
<p><strong>L∆∞u √Ω quan tr·ªçng:</strong></p>
<ul>
<li><strong>ƒê∆∞·ªùng d·∫´n file:</strong>  H√£y ƒë·∫£m b·∫£o r·∫±ng ƒë∆∞·ªùng d·∫´n ƒë·∫øn file CSV c·ªßa b·∫°n (<code>data_file</code>) l√† ch√≠nh x√°c.  S·ª≠ d·ª•ng <code>os.path.join</code> ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh t∆∞∆°ng th√≠ch tr√™n c√°c h·ªá ƒëi·ªÅu h√†nh kh√°c nhau.</li>
<li><strong>X·ª≠ l√Ω l·ªói:</strong>  Lu√¥n lu√¥n c√≥ c√°c kh·ªëi <code>try...except</code> ƒë·ªÉ x·ª≠ l√Ω c√°c l·ªói c√≥ th·ªÉ x·∫£y ra trong qu√° tr√¨nh t√≠nh to√°n c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a.</li>
<li><strong>Ch·ªçn ƒë·∫∑c t√≠nh l√Ω h√≥a ph√π h·ª£p:</strong>  T√πy thu·ªôc v√†o m·ª•c ti√™u nghi√™n c·ª©u c·ªßa b·∫°n, h√£y ch·ªçn c√°c ƒë·∫∑c t√≠nh l√Ω h√≥a ph√π h·ª£p ƒë·ªÉ ph√¢n t√≠ch.</li>
<li><strong>Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu c·∫©n th·∫≠n:</strong>  Vi·ªác l√†m s·∫°ch v√† chu·∫©n h√≥a d·ªØ li·ªáu l√† r·∫•t quan tr·ªçng ƒë·ªÉ ƒë·∫£m b·∫£o k·∫øt qu·∫£ ph√¢n t√≠ch ch√≠nh x√°c.</li>
<li><strong>S·ª≠ d·ª•ng c√°c m√¥ h√¨nh h·ªçc m√°y ph√π h·ª£p:</strong>  N·∫øu b·∫°n s·ª≠ d·ª•ng c√°c m√¥ h√¨nh h·ªçc m√°y, h√£y ch·ªçn c√°c m√¥ h√¨nh ph√π h·ª£p v·ªõi lo·∫°i d·ªØ li·ªáu v√† m·ª•c ti√™u c·ªßa b·∫°n.  ƒê√°nh gi√° hi·ªáu su·∫•t c·ªßa m√¥ h√¨nh b·∫±ng c√°c ph∆∞∆°ng ph√°p ph√π h·ª£p (v√≠ d·ª•: cross-validation).</li>
</ul>
<p>Ch√∫c b·∫°n th√†nh c√¥ng v·ªõi d·ª± √°n c·ªßa m√¨nh! N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi n√†o kh√°c, ƒë·ª´ng ng·∫ßn ng·∫°i h·ªèi.</p>
        </body>
        </html>
        